<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2299.5">
  <style type="text/css">
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; color: #0000e9; -webkit-text-stroke: #0000dc}
    p.p4 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000; min-height: 14.0px}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Helvetica; -webkit-text-stroke: #000000}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Helvetica; -webkit-text-stroke: #000000; min-height: 16.0px}
    p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #b0b0b0}
    p.p12 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000; min-height: 14.0px}
    p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #bebebe}
    p.p14 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #39b68f}
    p.p15 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #bebebe; min-height: 14.0px}
    p.p16 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #497a34}
    p.p17 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #a756a4}
    p.p18 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #cacf88}
    p.p19 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #7cc8fd}
    p.p20 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #b36a52}
    p.p21 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #37a2ff}
    p.p22 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #97bb86}
    li.li2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000}
    li.li5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; color: #0000e9; -webkit-text-stroke: #000000}
    span.s1 {font-kerning: none}
    span.s2 {font-kerning: none; color: #000000; -webkit-text-stroke: 0px #000000}
    span.s3 {text-decoration: underline ; font-kerning: none; -webkit-text-stroke: 0px #0000dc}
    span.s4 {color: #0000e9; -webkit-text-stroke: 0px #000000}
    span.s5 {-webkit-text-stroke: 0px #000000}
    span.s6 {font: 12.0px Helvetica; text-decoration: underline ; font-kerning: none; color: #0000e9; -webkit-text-stroke: 0px #0000dc}
    span.s7 {text-decoration: underline ; font-kerning: none}
    span.s8 {font: 6.9px Helvetica; font-kerning: none}
    span.s9 {font: 13.0px Helvetica; font-kerning: none; -webkit-text-stroke: 0px #000000}
    span.s10 {font-kerning: none; -webkit-text-stroke: 0px #a756a4}
    span.s11 {font-kerning: none; -webkit-text-stroke: 0px #bebebe}
    span.s12 {font-kerning: none; -webkit-text-stroke: 0px #3874c0}
    span.s13 {font-kerning: none; -webkit-text-stroke: 0px #37a2ff}
    span.s14 {font-kerning: none; -webkit-text-stroke: 0px #39b68f}
    span.s15 {font-kerning: none; -webkit-text-stroke: 0px #cacf88}
    span.s16 {font-kerning: none; -webkit-text-stroke: 0px #97bb86}
    span.s17 {font-kerning: none; -webkit-text-stroke: 0px #7cc8fd}
    span.s18 {font: 13.0px Helvetica; font-kerning: none}
    span.s19 {font-kerning: none; -webkit-text-stroke: 0px #000000}
    span.s20 {font-kerning: none; -webkit-text-stroke: 0px #b36a52}
    span.s21 {font: 18.0px Helvetica; text-decoration: underline ; font-kerning: none; color: #0000e9; -webkit-text-stroke: 0px #0000dc}
    span.s22 {font-kerning: none; -webkit-text-stroke: 0px #497a34}
    span.s23 {font-kerning: none; -webkit-text-stroke: 0px #c19e57}
    span.Apple-tab-span {white-space:pre}
    ul.ul1 {list-style-type: disc}
  </style>
</head>
<body>
<h1 style="margin: 0.0px 0.0px 16.1px 0.0px; font: 24.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">HCI/CprE/ComS 575: Homework #5</span></h1>
<p class="p2"><span class="s1">Mina</span></p>
<p class="p3"><span class="s2">&lt; <a href="mailto:Your%20Email"><span class="s3">minaghj@iastate.edu</span></a>&gt;</span></p>
<p class="p4"><span class="s1">The following libraries and references may be useful for solving this homework.</span></p>
<ul class="ul1">
  <li class="li2"><span class="s4"><a href="https://github.com/sukhoy/nanohmm"><span class="s3">NanoHMM library</span></a></span><span class="s1"> (includes both C and Python implementations).</span></li>
  <li class="li2"><span class="s5"></span><span class="s1">A tutorial on HMMs: <a href="https://www.ece.ucsb.edu/Faculty/Rabiner/ece259/Reprints/tutorial%20on%20hmm%20and%20applications.pdf"><span class="s6">paper</span></a> and <a href="http://alumni.media.mit.edu/~rahimi/rabiner/rabiner-errata/rabiner-errata.html"><span class="s6">errata</span></a>.<span class="Apple-converted-space"> </span></span></li>
  <li class="li5"><span class="s5"><a href="https://en.wikipedia.org/wiki/Forward%E2%80%93backward_algorithm"><span class="s7">The Wikipedia article on the Forward-Backward algorithm.<span class="Apple-converted-space"> </span></span></a></span></li>
</ul>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 1: Slow Forward Algorithm</span></h2>
<p class="p4"><span class="s1">Implement the "slow" version of the forward algorithm. It should run in O(N</span><span class="s8"><sup>T</sup></span><span class="s1">). It should support at least 4 states and sequences of length at least 5. This should be your own code, i.e., you are not allowed to use any other libraries or implementations for this part.</span></p>
<p class="p4"><span class="s1">In other words, your code needs to compute the long expression for L (see the example from the lecture for N=2 and T=3).</span></p>
<p class="p4"><span class="s1">Hint: Think of multiple nested for loops to enumerate all possible state sequences. Alternatively, you can use recursion. If you are writing this in Python, consider using the itertools module that can simplify things for the programmer for tasks like this.</span></p>
<p class="p2"><span class="s1">Source</span></p>
<p class="p8"><span class="s1">// def forward_algorithm_slow(observations, transition_probs, emission_probs, initial_probs):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>T = len(observations)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>N = len(initial_probs)</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>alpha = [[0.0]*N for i in range(T)]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># initialization</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for i in range(N):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>alpha[0][i] = initial_probs[i] * emission_probs[i][observations[0]]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># induction</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for t in range(1, T):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>for i in range(N):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>alpha[t][i] = 0.0</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>for j in range(N):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>alpha[t][i] += alpha[t-1][j] * transition_probs[j][i] * emission_probs[i][observations[t]]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># termination</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>L = sum(alpha[T-1])</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>return L</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 2: The Forward Algorithm</span></h2>
<p class="p4"><span class="s1">Implement the Forward algorithm that runs in O(N</span><span class="s8"><sup>2</sup></span><span class="s1">T). It should support sequences of length at least 8 with at least 5 states. Because these numbers are relatively small, your code doesn't have to re-normalize the probabilities at each step of the algorithm. This should be your own code, i.e., you are not allowed to use any other libraries or implementations for this part.</span></p>
<p class="p2"><span class="s1">Source</span></p>
<p class="p8"><span class="s1">// def forward_algorithm(observations, transition_probs, emission_probs, initial_probs):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>T = len(observations)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>N = len(initial_probs)</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>alpha = [[0.0]*N for i in range(T)]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># initialization</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for i in range(N):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>alpha[0][i] = initial_probs[i] * emission_probs[i][observations[0]]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># induction</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for t in range(1, T):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>for i in range(N):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>alpha[t][i] = 0.0</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>for j in range(N):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>alpha[t][i] += alpha[t-1][j] * transition_probs[j][i]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>alpha[t][i] *= emission_probs[i][observations[t]]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span># optimization to avoid nested loops for normalization</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>if t % 2 == 0:</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>norm = sum(alpha[t-1])</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>for k in range(N):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>alpha[t-1][k] /= norm</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># normalization of last row</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>norm = sum(alpha[T-1])</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for i in range(N):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>alpha[T-1][i] /= norm</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># termination</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>L = sum(alpha[T-1])</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>return L</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 3: Forward Check</span></h2>
<p class="p4"><span class="s1">Check your implementation of the forward algorithm by computing the forward variable alpha for the observation sequence O=(0,1,0,2,0,1,0) given the HMM.</span></p>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; font: 14.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 3A: Forward Check Using HMM with Two States</span></h3>
<p class="p4"><span class="s1">The HMM for Part 3A is specified below:</span></p>
<p class="p8"><span class="s1">A = [[0.66, 0.34],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[1, 0]]</span></p>
<p class="p8"><span class="s1">B = [[0.5, 0.25, 0.25],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0.1, 0.1, 0.8]]</span></p>
<p class="p8"><span class="s1">pi = [0.8, 0.2]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p2"><span class="s1">Result</span></p>
<p class="p11"><span class="s9">// </span><span class="s1">Alpha values for the given observation sequence:</span></p>
<p class="p11"><span class="s1"><span class="Apple-converted-space"> </span>[[0.4, 0.020000000000000004], [0.07100000000000001, 0.013600000000000001], [0.030230000000000003, 0.0024140000000000008], [0.00559145, 0.008222560000000002], [0.005956458500000001, 0.00019010930000000004], [0.0010303429775000003, 0.00020251958900000005], [0.00044127297707500016, 3.503166123500001e-05]]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; font: 14.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 3B: Forward Check Using HMM with Three States</span></h3>
<p class="p4"><span class="s1">The HMM for Part 3B is specified below:</span></p>
<p class="p8"><span class="s1">A = [[0.8, 0.1, 0.1],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0.4, 0.2, 0.4],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0, 0.3, 0.7]]</span></p>
<p class="p8"><span class="s1">B = [[0.66, 0.34, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0, 0, 1],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0.5, 0.4, 0.1]]</span></p>
<p class="p8"><span class="s1">pi = [0.6, 0, 0.4]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p2"><span class="s1">Result</span></p>
<p class="p11"><span class="s9">// </span><span class="s1">Alpha values for the given observation sequence:</span></p>
<p class="p11"><span class="s1"><span class="Apple-converted-space"> </span>[[0.20400000000000001, 0, 0.16000000000000003], [0.10771200000000002, 0.0, 0.06620000000000001], [0.0, 0.030631200000000004, 0.005711120000000001], [0.004165843200000002, 0.0, 0.006500105600000002], [0.0011331093504000007, 0.0, 0.001986663296], [0.0005982817370112004, 0.0, 0.00075198762112], [0.00016273263246704655, 0.0, 0.00023448780339404803], [0.0, 8.661960426491906e-05, 1.8041472562253826e-05]]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">      </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 4: The Backward Algorithm</span></h2>
<p class="p4"><span class="s1">Implement the Backward algorithm that runs in O(N</span><span class="s8"><sup>2</sup></span><span class="s1">T). It should support sequences of length at least 8 with at least 5 states. Because these numbers are relatively small, your code doesn't have to re-normalize the probabilities at each step of the algorithm. This should be your own code, i.e., you are not allowed to use any other libraries or implementations for this part.</span></p>
<p class="p2"><span class="s1">Source</span></p>
<p class="p8"><span class="s1">//<span class="Apple-converted-space"> </span></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">def backward(observation_sequence, A, B, pi):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>num_states = len(A)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>T = len(observation_sequence)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>beta = [[0.0] * num_states for _ in range(T)]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Initialize beta at time T</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for i in range(num_states):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>beta[T-1][i] = 1.0</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Compute beta for each time step t &lt; T-1</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for t in range(T-2, -1, -1):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>for i in range(num_states):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>beta[t][i] = sum(A[i][j] * B[j][observation_sequence[t+1]] * beta[t+1][j] for j in range(num_states))</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>return beta</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">       <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 5: Backward Check</span></h2>
<p class="p4"><span class="s1">Check your implementation of the backward algorithm by computing the backward variable beta for the observation sequence O=(0,1,0,2,0,1,0) given the HMM.</span></p>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; font: 14.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 5A: Backward Check Using HMM with Two States</span></h3>
<p class="p4"><span class="s1">The HMM for Part 5A is specified below:</span></p>
<p class="p8"><span class="s1">A = [[0.66, 0.34],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[1, 0]]</span></p>
<p class="p8"><span class="s1">B = [[0.5, 0.25, 0.25],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0.1, 0.1, 0.8]]</span></p>
<p class="p8"><span class="s1">pi = [0.8, 0.2]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">          </span></span></p>
<p class="p2"><span class="s1">Result</span></p>
<p class="p11"><span class="s9">// </span><span class="s1">Beta values for the given observation sequence:</span></p>
<p class="p11"><span class="s1"><span class="Apple-converted-space"> </span>[[0.0011250862706500002, 0.0013135065025000003], [0.005254026010000001, 0.007593293500000001], [0.015186587000000001, 0.0071309500000000005], [0.028523800000000002, 0.03853], [0.07706, 0.091], [0.364, 0.5], [1.0, 1.0]]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">          </span></span></p>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; font: 14.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 5B: Backward Check Using HMM with Three States</span></h3>
<p class="p4"><span class="s1">The HMM for Part 5B is specified below:</span></p>
<p class="p8"><span class="s1">A = [[0.8, 0.1, 0.1],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0.4, 0.2, 0.4],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0, 0.3, 0.7]]</span></p>
<p class="p8"><span class="s1">B = [[0.66, 0.34, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0, 0, 1],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0.5, 0.4, 0.1]]</span></p>
<p class="p8"><span class="s1">pi = [0.6, 0, 0.4]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">          </span></span></p>
<p class="p2"><span class="s1">Result</span></p>
<p class="p11"><span class="s9">// </span><span class="s1">Beta values for the given observation sequence:</span></p>
<p class="p11"><span class="s1"><span class="Apple-converted-space"> </span>[[0.0015827267529984006, 0.0018615874292992004, 0.0021404481056], [0.004694663427200001, 0.006169560473600001, 0.007644457520000001], [0.006823102400000002, 0.014332204800000003, 0.021841307200000003], [0.09530204800000003, 0.06480102400000001, 0.0343], [0.17121600000000003, 0.134608, 0.09799999999999999], [0.5780000000000001, 0.464, 0.35], [1.0, 1.0, 1.0]]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 6: Likelihood Calculation</span></h2>
<p class="p4"><span class="s1">Compute the likelihood for each of the following five observation sequences given the same HMM model:</span></p>
<p class="p8"><span class="s1">O1 = (1,0,0,0,1,0,1)</span></p>
<p class="p8"><span class="s1">O2 = (0,0,0,1,1,2,0)</span></p>
<p class="p8"><span class="s1">O3 = (1,1,0,1,0,1,2)</span></p>
<p class="p8"><span class="s1">O4 = (0,1,0,2,0,1,0)</span></p>
<p class="p8"><span class="s1">O5 = (2,2,0,1,1,0,1)</span></p>
<p class="p12"><span class="s1"></span><br></p>
<p class="p4"><span class="s1">The HMM for Part 6 is specified below:</span></p>
<p class="p8"><span class="s1">A = [[0.6, 0.4],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[1, 0]]</span></p>
<p class="p8"><span class="s1">B = [[0.7, 0.3, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0.1, 0.1, 0.8]]</span></p>
<p class="p8"><span class="s1">pi = [0.7, 0.3]</span></p>
<p class="p12"><span class="s1"></span><br></p>
<p class="p4"><span class="s1">Hint: Compute this by adding the elements in the last column of the alpha array that is computed by your Forward algorithm.</span></p>
<p class="p2"><span class="s1">Result</span></p>
<p class="p8"><span class="s1">//<span class="Apple-converted-space"> </span></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p11"><span class="s1">Likelihood of O1: 0.0006833869593599999</span></p>
<p class="p11"><span class="s1">Likelihood of O2: 0.0011935666175999994</span></p>
<p class="p11"><span class="s1">Likelihood of O3: 0.00018577575935999999</span></p>
<p class="p11"><span class="s1">Likelihood of O4: 0.0013537384447999997</span></p>
<p class="p11"><span class="s1">Likelihood of O5: 0.0</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 7: Likelihood Verification</span></h2>
<p class="p4"><span class="s1">Verify your implementations of the Forward algorithm and the Backward algorithm by computing the likelihood of the observation sequence in multiple ways. More specifically, show that the likelihood value can be computed by performing the dot product between the corresponding column of the forward array and the backward array for each t using the following HMM:</span></p>
<p class="p8"><span class="s1">A = [[0.6, 0.4],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[1, 0]]</span></p>
<p class="p8"><span class="s1">B = [[0.7, 0.3, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">     </span>[0.1, 0.1, 0.8]]</span></p>
<p class="p8"><span class="s1">pi = [0.7, 0.3]</span></p>
<p class="p12"><span class="s1"></span><br></p>
<p class="p4"><span class="s1">The observation sequences are:</span></p>
<p class="p8"><span class="s1">O1 = (1,0,0,0,1,0,1)</span></p>
<p class="p8"><span class="s1">O2 = (0,0,0,1,1,2,0)</span></p>
<p class="p8"><span class="s1">O3 = (1,1,0,1,0,1,2)</span></p>
<p class="p8"><span class="s1">O4 = (0,1,0,2,0,1,0)</span></p>
<p class="p8"><span class="s1">O5 = (2,2,0,1,1,0,1)</span></p>
<p class="p12"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Result</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>t=1 <span class="Apple-converted-space">  <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>t=2 <span class="Apple-converted-space">  <span class="Apple-tab-span">	</span></span>t=3 <span class="Apple-converted-space">  <span class="Apple-tab-span">	</span></span>t=4 <span class="Apple-converted-space">  <span class="Apple-tab-span">	</span></span>t=5 <span class="Apple-converted-space">  <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>t=6 <span class="Apple-converted-space">  <span class="Apple-tab-span">	</span></span>t=7</span></p>
<p class="p13"><span class="s1">Observation 1: [0.00068339 0.00068339 0.00068339 0.00068339 0.00068339 0.00068339 0.00068339]</span></p>
<p class="p13"><span class="s1">Observation 2: [0.00119357 0.00119357 0.00119357 0.00119357 0.00119357 0.00119357 0.00119357]</span></p>
<p class="p13"><span class="s1">Observation 3: [0.00018578 0.00018578 0.00018578 0.00018578 0.00018578 0.00018578 0.00018578]</span></p>
<p class="p13"><span class="s1">Observation 4: [0.00135374 0.00135374 0.00135374 0.00135374 0.00135374 0.00135374 0.00135374]</span></p>
<p class="p13"><span class="s1">Observation 5: [0. 0. 0. 0. 0. 0. 0.]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p2"><span class="s1">Code</span></p>
<p class="p14"><span class="s9">//</span><span class="s10">import</span><span class="s11"> </span><span class="s1">numpy</span><span class="s11"> </span><span class="s12">as</span><span class="s11"> </span><span class="s1">np</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define HMM</span></p>
<p class="p13"><span class="s13">A</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.6</span><span class="s1">, </span><span class="s16">0.4</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">              </span>[</span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">]])</span></p>
<p class="p13"><span class="s13">B</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.7</span><span class="s1">, </span><span class="s16">0.3</span><span class="s1">, </span><span class="s16">0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">              </span>[</span><span class="s16">0.1</span><span class="s1">, </span><span class="s16">0.1</span><span class="s1">, </span><span class="s16">0.8</span><span class="s1">]])</span></p>
<p class="p13"><span class="s17">pi</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0.7</span><span class="s1">, </span><span class="s16">0.3</span><span class="s1">])</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define observation sequences</span></p>
<p class="p13"><span class="s13">O1</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">])</span></p>
<p class="p13"><span class="s13">O2</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">2</span><span class="s1">, </span><span class="s16">0</span><span class="s1">])</span></p>
<p class="p13"><span class="s13">O3</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">1</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">2</span><span class="s1">])</span></p>
<p class="p13"><span class="s13">O4</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">2</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">])</span></p>
<p class="p13"><span class="s13">O5</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">2</span><span class="s1">, </span><span class="s16">2</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">])</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define the forward algorithm</span></p>
<p class="p13"><span class="s12">def</span><span class="s1"> </span><span class="s15">forward</span><span class="s1">(</span><span class="s17">A</span><span class="s1">, </span><span class="s17">B</span><span class="s1">, </span><span class="s17">pi</span><span class="s1">, </span><span class="s17">O</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s13">T</span><span class="s1"> = </span><span class="s15">len</span><span class="s1">(</span><span class="s17">O</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s13">N</span><span class="s1"> = </span><span class="s17">A</span><span class="s1">.shape[</span><span class="s16">0</span><span class="s1">]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">alpha</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">((</span><span class="s13">T</span><span class="s1">, </span><span class="s13">N</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s16">0</span><span class="s1">] = </span><span class="s17">pi</span><span class="s1"> * </span><span class="s17">B</span><span class="s1">[:, </span><span class="s17">O</span><span class="s1">[</span><span class="s16">0</span><span class="s1">]]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s16">1</span><span class="s1">, </span><span class="s13">T</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">t</span><span class="s1">-</span><span class="s16">1</span><span class="s1">] @ </span><span class="s17">A</span><span class="s1"> * </span><span class="s17">B</span><span class="s1">[:, </span><span class="s17">O</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]]</span></p>
<p class="p17"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s11"> </span><span class="s17">alpha</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define the backward algorithm</span></p>
<p class="p13"><span class="s12">def</span><span class="s1"> </span><span class="s15">backward</span><span class="s1">(</span><span class="s17">A</span><span class="s1">, </span><span class="s17">B</span><span class="s1">, </span><span class="s17">O</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s13">T</span><span class="s1"> = </span><span class="s15">len</span><span class="s1">(</span><span class="s17">O</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s13">N</span><span class="s1"> = </span><span class="s17">A</span><span class="s1">.shape[</span><span class="s16">0</span><span class="s1">]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">beta</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">((</span><span class="s13">T</span><span class="s1">, </span><span class="s13">N</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">beta</span><span class="s1">[-</span><span class="s16">1</span><span class="s1">] = </span><span class="s16">1</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">T</span><span class="s1">-</span><span class="s16">2</span><span class="s1">, -</span><span class="s16">1</span><span class="s1">, -</span><span class="s16">1</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">beta</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s17">A</span><span class="s1"> @ (</span><span class="s17">B</span><span class="s1">[:, </span><span class="s17">O</span><span class="s1">[</span><span class="s17">t</span><span class="s1">+</span><span class="s16">1</span><span class="s1">]] * </span><span class="s17">beta</span><span class="s1">[</span><span class="s17">t</span><span class="s1">+</span><span class="s16">1</span><span class="s1">])</span></p>
<p class="p17"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s11"> </span><span class="s17">beta</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Function to compute likelihood using dot product between forward and backward arrays</span></p>
<p class="p18"><span class="s12">def</span><span class="s11"> </span><span class="s1">compute_likelihood</span><span class="s11">(</span><span class="s17">observation</span><span class="s11">):</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s13">T</span><span class="s11"> = </span><span class="s15">len</span><span class="s11">(</span><span class="s1">observation</span><span class="s11">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">alpha</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">((</span><span class="s13">T</span><span class="s1">, </span><span class="s16">2</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">beta</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">((</span><span class="s13">T</span><span class="s1">, </span><span class="s16">2</span><span class="s1">))</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1"># Initialize alpha and beta</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s16">0</span><span class="s1">] = </span><span class="s17">pi</span><span class="s1"> * </span><span class="s13">B</span><span class="s1">[:, </span><span class="s17">observation</span><span class="s1">[</span><span class="s16">0</span><span class="s1">]]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">beta</span><span class="s1">[</span><span class="s13">T</span><span class="s1">-</span><span class="s16">1</span><span class="s1">] = </span><span class="s16">1</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1"># Compute alpha and beta</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s16">1</span><span class="s1">, </span><span class="s13">T</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">t</span><span class="s1">-</span><span class="s16">1</span><span class="s1">] @ </span><span class="s13">A</span><span class="s1"> * </span><span class="s13">B</span><span class="s1">[:, </span><span class="s17">observation</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">beta</span><span class="s1">[</span><span class="s13">T</span><span class="s1">-</span><span class="s17">t</span><span class="s1">-</span><span class="s16">1</span><span class="s1">] = </span><span class="s13">A</span><span class="s1"> @ (</span><span class="s13">B</span><span class="s1">[:, </span><span class="s17">observation</span><span class="s1">[</span><span class="s13">T</span><span class="s1">-</span><span class="s17">t</span><span class="s1">]] * </span><span class="s17">beta</span><span class="s1">[</span><span class="s13">T</span><span class="s1">-</span><span class="s17">t</span><span class="s1">])</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1"># Compute likelihood for each observation element</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">likelihood</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">(</span><span class="s13">T</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">T</span><span class="s1">):</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1">likelihood</span><span class="s11">[</span><span class="s1">t</span><span class="s11">] = </span><span class="s1">alpha</span><span class="s11">[</span><span class="s1">t</span><span class="s11">] @ </span><span class="s1">beta</span><span class="s11">[</span><span class="s1">t</span><span class="s11">]</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s10">return</span><span class="s11"> </span><span class="s1">likelihood</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Compute likelihood for each observation sequence</span></p>
<p class="p19"><span class="s1">likelihoods</span><span class="s11"> = []</span></p>
<p class="p13"><span class="s10">for</span><span class="s1"> </span><span class="s17">observation</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> [</span><span class="s13">O1</span><span class="s1">, </span><span class="s13">O2</span><span class="s1">, </span><span class="s13">O3</span><span class="s1">, </span><span class="s13">O4</span><span class="s1">, </span><span class="s13">O5</span><span class="s1">]:</span></p>
<p class="p18"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s17">likelihoods</span><span class="s11">.</span><span class="s1">append</span><span class="s11">(</span><span class="s1">compute_likelihood</span><span class="s11">(</span><span class="s17">observation</span><span class="s11">))</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Print likelihoods</span></p>
<p class="p19"><span class="s10">for</span><span class="s11"> </span><span class="s1">i</span><span class="s11">, </span><span class="s1">likelihood</span><span class="s11"> </span><span class="s12">in</span><span class="s11"> </span><span class="s14">enumerate</span><span class="s11">(</span><span class="s1">likelihoods</span><span class="s11">):</span></p>
<p class="p20"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s15">print</span><span class="s11">(f</span><span class="s1">"Observation {</span><span class="s17">i</span><span class="s1">+1}: </span><span class="s17">{likelihood}</span><span class="s1">"</span><span class="s11">)</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 8: Match Sequences to HMMs</span></h2>
<p class="p4"><span class="s1">Use your implementation of the Forward algorithm to compute the likelihood for each of the following five observation sequences given each of the following five HMMs. Fill the table below and indicate with * the most probable HMM for each sequence.</span></p>
<p class="p4"><span class="s1">The observation sequences are:</span></p>
<p class="p8"><span class="s1">O1 = (1,0,0,0,1,0,1)</span></p>
<p class="p8"><span class="s1">O2 = (0,0,0,1,1,2,0)</span></p>
<p class="p8"><span class="s1">O3 = (1,1,0,1,0,1,2)</span></p>
<p class="p8"><span class="s1">O4 = (0,1,0,2,0,1,0)</span></p>
<p class="p8"><span class="s1">O5 = (2,2,0,1,1,0,1)</span></p>
<p class="p12"><span class="s1"></span><br></p>
<p class="p4"><span class="s1">The HMMs are:</span></p>
<p class="p8"><span class="s1">HMM 1:</span></p>
<p class="p8"><span class="s1">A =<span class="Apple-converted-space">  </span>[[1.0, 0.0], [0.5, 0.5]]</span></p>
<p class="p8"><span class="s1">B =<span class="Apple-converted-space">  </span>[[0.4, 0.6, 0.0], [0.0, 0.0, 1.0]]</span></p>
<p class="p8"><span class="s1">pi =<span class="Apple-converted-space">  </span>[0.0, 1.0]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">HMM 2:</span></p>
<p class="p8"><span class="s1">A =<span class="Apple-converted-space">  </span>[[0.25, 0.75], [1.0, 0.0]]</span></p>
<p class="p8"><span class="s1">B =<span class="Apple-converted-space">  </span>[[0, 1.0, 0], [0.66, 0.0, 0.34]]</span></p>
<p class="p8"><span class="s1">pi =<span class="Apple-converted-space">  </span>[1.0, 0.0]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">HMM 3:</span></p>
<p class="p8"><span class="s1">A =<span class="Apple-converted-space">  </span>[[0.0, 1.0], [1.0, 0.0]]</span></p>
<p class="p8"><span class="s1">B =<span class="Apple-converted-space">  </span>[[1.0, 0.0, 0.0], [0.0, 0.66, 0.34]]</span></p>
<p class="p8"><span class="s1">pi =<span class="Apple-converted-space">  </span>[1.0, 0.0]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">HMM 4:</span></p>
<p class="p8"><span class="s1">A =<span class="Apple-converted-space">  </span>[[1, 0], [0.44, 0.56]]</span></p>
<p class="p8"><span class="s1">B =<span class="Apple-converted-space">  </span>[[0.36, 0.42, 0.22], [1.0, 0, 0]]</span></p>
<p class="p8"><span class="s1">pi =<span class="Apple-converted-space">  </span>[0, 1.0]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">HMM 5:</span></p>
<p class="p8"><span class="s1">A =<span class="Apple-converted-space">  </span>[[0.0, 1.0], [1.0, 0.0]]</span></p>
<p class="p8"><span class="s1">B =<span class="Apple-converted-space">  </span>[[0.25, 0.75, 0.0], [1.0, 0.0, 0.0]]</span></p>
<p class="p8"><span class="s1">pi =<span class="Apple-converted-space">  </span>[1.0, 0.0]</span></p>
<p class="p12"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Result</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>HMM1<span class="Apple-converted-space">        </span>HMM2<span class="Apple-converted-space">            </span>HMM3<span class="Apple-converted-space">        </span>HMM4 <span class="Apple-converted-space">                    </span>HMM5</span></p>
<p class="p2"><span class="s18">O1<span class="Apple-converted-space">  </span>L=</span><span class="s11">0.0</span><span class="s18"> <span class="Apple-converted-space">      </span>L= </span><span class="s11">0.0</span><span class="s18"> <span class="Apple-converted-space">          </span>L= </span><span class="s11">0.0<span class="Apple-converted-space">      </span></span><span class="s18">L= </span><span class="s1">0.0 <span class="Apple-converted-space">                    </span></span><span class="s18">L= </span><span class="s11">0.10546875</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s18">O2<span class="Apple-converted-space">  </span>L=</span><span class="s11">0.0</span><span class="s18"> <span class="Apple-converted-space">      </span>L= </span><span class="s11">0.0</span><span class="s18"> <span class="Apple-converted-space">          </span>L= </span><span class="s11">0.0</span><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s18">L= </span><span class="s11">0.00396370630656<span class="Apple-converted-space">        </span></span><span class="s18">L= </span><span class="s1">0.0<span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s18">O3<span class="Apple-converted-space">  </span>L=</span><span class="s11">0.0</span><span class="s18"> <span class="Apple-converted-space">      </span>L= </span><span class="s11">0.01562034375<span class="Apple-converted-space">  </span></span><span class="s18">L= </span><span class="s11">0.0</span><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s18">L= </span><span class="s1">0.0 <span class="Apple-converted-space">                    </span></span><span class="s18">L= </span><span class="s1">0.0<span class="Apple-converted-space"> </span></span></p>
<p class="p13"><span class="s9">O4<span class="Apple-converted-space">  </span>L=</span><span class="s1">0.0</span><span class="s9"> <span class="Apple-converted-space">      </span>L= </span><span class="s1">0.0<span class="Apple-converted-space">            </span></span><span class="s9">L= </span><span class="s1">0.148104</span><span class="s19"> </span><span class="s9">L= </span><span class="s1">0.0007966754611199998</span><span class="s19"> <span class="Apple-converted-space">  </span></span><span class="s9">L= </span><span class="s19">0.0<span class="Apple-converted-space">   </span></span></p>
<p class="p2"><span class="s18">O5<span class="Apple-converted-space">  </span>L= </span><span class="s11">0.00864</span><span class="s18"><span class="Apple-converted-space">  </span>L= </span><span class="s11">0.0<span class="Apple-converted-space">            </span></span><span class="s18">L= </span><span class="s11">0.0</span><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s18">L= </span><span class="s1">0.0 <span class="Apple-converted-space">                    </span></span><span class="s18">L= </span><span class="s1">0.0<span class="Apple-converted-space"> </span></span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p2"><span class="s1">Code</span></p>
<p class="p14"><span class="s9">// </span><span class="s10">import</span><span class="s11"> </span><span class="s1">numpy</span><span class="s11"> </span><span class="s12">as</span><span class="s11"> </span><span class="s1">np</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s12">def</span><span class="s1"> </span><span class="s15">backward</span><span class="s1">(</span><span class="s17">O</span><span class="s1">, </span><span class="s17">A</span><span class="s1">, </span><span class="s17">B</span><span class="s1">, </span><span class="s17">pi</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s13">T</span><span class="s1"> = </span><span class="s15">len</span><span class="s1">(</span><span class="s17">O</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s13">N</span><span class="s1"> = </span><span class="s17">A</span><span class="s1">.shape[</span><span class="s16">0</span><span class="s1">]</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">beta</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">((</span><span class="s13">N</span><span class="s1">, </span><span class="s13">T</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">beta</span><span class="s1">[:, -</span><span class="s16">1</span><span class="s1">] = </span><span class="s16">1</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">T</span><span class="s1">-</span><span class="s16">2</span><span class="s1">, -</span><span class="s16">1</span><span class="s1">, -</span><span class="s16">1</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">i</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">N</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">beta</span><span class="s1">[</span><span class="s17">i</span><span class="s1">, </span><span class="s17">t</span><span class="s1">] = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">sum</span><span class="s1">(</span><span class="s17">beta</span><span class="s1">[:, </span><span class="s17">t</span><span class="s1">+</span><span class="s16">1</span><span class="s1">] * </span><span class="s17">B</span><span class="s1">[:, </span><span class="s17">O</span><span class="s1">[</span><span class="s17">t</span><span class="s1">+</span><span class="s16">1</span><span class="s1">]] * </span><span class="s17">A</span><span class="s1">[</span><span class="s17">i</span><span class="s1">, :])</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p17"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s11"> </span><span class="s17">beta</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s12">def</span><span class="s1"> </span><span class="s15">forward</span><span class="s1">(</span><span class="s17">O</span><span class="s1">, </span><span class="s17">A</span><span class="s1">, </span><span class="s17">B</span><span class="s1">, </span><span class="s17">pi</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s13">T</span><span class="s1"> = </span><span class="s15">len</span><span class="s1">(</span><span class="s17">O</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s13">N</span><span class="s1"> = </span><span class="s17">A</span><span class="s1">.shape[</span><span class="s16">0</span><span class="s1">]</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">alpha</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">((</span><span class="s13">N</span><span class="s1">, </span><span class="s13">T</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">alpha</span><span class="s1">[:, </span><span class="s16">0</span><span class="s1">] = </span><span class="s17">pi</span><span class="s1"> * </span><span class="s17">B</span><span class="s1">[:, </span><span class="s17">O</span><span class="s1">[</span><span class="s16">0</span><span class="s1">]]</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s16">1</span><span class="s1">, </span><span class="s13">T</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">j</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">N</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">j</span><span class="s1">, </span><span class="s17">t</span><span class="s1">] = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">sum</span><span class="s1">(</span><span class="s17">alpha</span><span class="s1">[:, </span><span class="s17">t</span><span class="s1">-</span><span class="s16">1</span><span class="s1">] * </span><span class="s17">A</span><span class="s1">[:, </span><span class="s17">j</span><span class="s1">] * </span><span class="s17">B</span><span class="s1">[</span><span class="s17">j</span><span class="s1">, </span><span class="s17">O</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]])</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p17"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s11"> </span><span class="s17">alpha</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define HMM parameters</span></p>
<p class="p13"><span class="s13">HMM1</span><span class="s1"> = {</span><span class="s20">'A'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">], [</span><span class="s16">0.5</span><span class="s1">, </span><span class="s16">0.5</span><span class="s1">]]),</span></p>
<p class="p13"><span class="s17"><span class="Apple-converted-space">        </span></span><span class="s20">'B'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.4</span><span class="s1">, </span><span class="s16">0.6</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">], [</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">]]),</span></p>
<p class="p13"><span class="s17"><span class="Apple-converted-space">        </span></span><span class="s20">'pi'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">])}</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s13">HMM2</span><span class="s1"> = {</span><span class="s20">'A'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.25</span><span class="s1">, </span><span class="s16">0.75</span><span class="s1">], [</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">]]),</span></p>
<p class="p13"><span class="s17"><span class="Apple-converted-space">        </span></span><span class="s20">'B'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">], [</span><span class="s16">0.66</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.34</span><span class="s1">]]),</span></p>
<p class="p13"><span class="s17"><span class="Apple-converted-space">        </span></span><span class="s20">'pi'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">])}</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s13">HMM3</span><span class="s1"> = {</span><span class="s20">'A'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">], [</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">]]),</span></p>
<p class="p13"><span class="s17"><span class="Apple-converted-space">        </span></span><span class="s20">'B'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">], [</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.66</span><span class="s1">, </span><span class="s16">0.34</span><span class="s1">]]),</span></p>
<p class="p13"><span class="s17"><span class="Apple-converted-space">        </span></span><span class="s20">'pi'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">])}</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s13">HMM4</span><span class="s1"> = {</span><span class="s20">'A'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">], [</span><span class="s16">0.44</span><span class="s1">, </span><span class="s16">0.56</span><span class="s1">]]),</span></p>
<p class="p13"><span class="s17"><span class="Apple-converted-space">        </span></span><span class="s20">'B'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.36</span><span class="s1">, </span><span class="s16">0.42</span><span class="s1">, </span><span class="s16">0.22</span><span class="s1">], [</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">]]),</span></p>
<p class="p13"><span class="s17"><span class="Apple-converted-space">        </span></span><span class="s20">'pi'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">])}</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s13">HMM5</span><span class="s1"> = {</span><span class="s20">'A'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">], [</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">]]),</span></p>
<p class="p13"><span class="s17"><span class="Apple-converted-space">        </span></span><span class="s20">'B'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.25</span><span class="s1">, </span><span class="s16">0.75</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">], [</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">]]),</span></p>
<p class="p13"><span class="s17"><span class="Apple-converted-space">        </span></span><span class="s20">'pi'</span><span class="s1">: </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">])}</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define observation sequences</span></p>
<p class="p13"><span class="s13">O1</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">])</span></p>
<p class="p13"><span class="s13">O2</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">2</span><span class="s1">, </span><span class="s16">0</span><span class="s1">])</span></p>
<p class="p13"><span class="s13">O3</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">1</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">2</span><span class="s1">])</span></p>
<p class="p13"><span class="s13">O4</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">2</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">])</span></p>
<p class="p13"><span class="s13">O5</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">2</span><span class="s1">, </span><span class="s16">2</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">])</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Compute likelihoods for each HMM and each sequence</span></p>
<p class="p21"><span class="s17">HMMs</span><span class="s11"> = [</span><span class="s1">HMM1</span><span class="s11">, </span><span class="s1">HMM2</span><span class="s11">, </span><span class="s1">HMM3</span><span class="s11">, </span><span class="s1">HMM4</span><span class="s11">, </span><span class="s1">HMM5</span><span class="s11">]</span></p>
<p class="p13"><span class="s17">Os</span><span class="s1"> = [</span><span class="s13">O1</span><span class="s1">, </span><span class="s13">O2</span><span class="s1">, </span><span class="s13">O3</span><span class="s1">, </span><span class="s13">O4</span><span class="s1">, </span><span class="s13">O5</span><span class="s1">]</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p14"><span class="s10">for</span><span class="s11"> </span><span class="s17">i</span><span class="s11">, </span><span class="s13">HMM</span><span class="s11"> </span><span class="s12">in</span><span class="s11"> </span><span class="s1">enumerate</span><span class="s11">(</span><span class="s17">HMMs</span><span class="s11">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s13">A</span><span class="s1"> = </span><span class="s13">HMM</span><span class="s1">[</span><span class="s20">'A'</span><span class="s1">]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s13">B</span><span class="s1"> = </span><span class="s13">HMM</span><span class="s1">[</span><span class="s20">'B'</span><span class="s1">]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">pi</span><span class="s1"> = </span><span class="s13">HMM</span><span class="s1">[</span><span class="s20">'pi'</span><span class="s1">]</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s17">Ls</span><span class="s1"> = []</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">for</span><span class="s1"> </span><span class="s13">O</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s17">Os</span><span class="s1">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">alpha</span><span class="s1"> = </span><span class="s15">forward</span><span class="s1">(</span><span class="s13">O</span><span class="s1">, </span><span class="s13">A</span><span class="s1">, </span><span class="s13">B</span><span class="s1">, </span><span class="s17">pi</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">beta</span><span class="s1"> = </span><span class="s15">backward</span><span class="s1">(</span><span class="s13">O</span><span class="s1">, </span><span class="s13">A</span><span class="s1">, </span><span class="s13">B</span><span class="s1">, </span><span class="s17">pi</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s13">L</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">sum</span><span class="s1">(</span><span class="s17">alpha</span><span class="s1">[:, -</span><span class="s16">1</span><span class="s1">])</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">Ls</span><span class="s1">.</span><span class="s15">append</span><span class="s1">(</span><span class="s13">L</span><span class="s1">)</span></p>
<p class="p15"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p20"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s15">print</span><span class="s11">(f</span><span class="s1">"HMM{</span><span class="s17">i</span><span class="s1">+1} likelihoods: </span><span class="s17">{Ls}</span><span class="s1">"</span><span class="s11">)</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 9: Match Sequences to HMMs (using <a href="https://github.com/sukhoy/nanohmm"><span class="s21">NanoHMM</span></a>)</span></h2>
<p class="p4"><span class="s1">This problem is similar to Part 8, but the sequences are now longer and your Forward and Backward algorithms may no longer work because they don't perform renormalization at each step.</span></p>
<p class="p4"><span class="s1">Use the implementation of the Forward algorithm in the <a href="https://github.com/sukhoy/nanohmm"><span class="s6">NanoHMM</span></a> library to compute the log-likelihood for each of the following five observation sequences given each of the following five HMMs. Fill the table below and indicate with * the most likely HMM for each sequence. In all cases, N=5, M=6, and T=20.</span></p>
<p class="p8"><span class="s1">O1 = (4,2,5,1,5,1,5,3,2,3,2,0,1,0,0,4,4,3,0,1)</span></p>
<p class="p8"><span class="s1">O2 = (3,2,3,3,5,5,5,5,1,0,1,4,2,4,3,0,5,3,1,0)</span></p>
<p class="p8"><span class="s1">O3 = (4,3,0,3,4,0,1,0,2,0,5,3,2,0,0,5,5,3,5,4)</span></p>
<p class="p8"><span class="s1">O4 = (3,4,2,0,5,4,4,3,1,5,3,3,2,3,0,4,2,5,2,4)</span></p>
<p class="p8"><span class="s1">O5 = (2,0,5,4,4,2,0,5,5,4,4,2,0,5,4,4,5,5,5,5)</span></p>
<p class="p12"><span class="s1"></span><br></p>
<p class="p4"><span class="s1">The HMMs are:</span></p>
<p class="p8"><span class="s1">HMM 1:</span></p>
<p class="p8"><span class="s1">A =<span class="Apple-converted-space">  </span>[[0.33, 0, 0, 0.67, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.67, 0, 0.33, 0, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0, 1.0, 0.0, 0, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0, 0, 0, 0.25, 0.75],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 0.6, 0, 0.4]]</span></p>
<p class="p8"><span class="s1">B =<span class="Apple-converted-space">  </span>[[0.67, 0, 0, 0, 0, 0.33],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 1.0, 0, 0, 0, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.5, 0, 0, 0, 0, 0.5],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0, 0, 0, 0.25, 0.75, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0, 0.0, 0.6, 0.4, 0, 0.0]]</span></p>
<p class="p8"><span class="s1">pi =<span class="Apple-converted-space">  </span>[0.0, 0.0, 0.0, 1.0, 0.0]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">HMM 2:</span></p>
<p class="p8"><span class="s1">A =<span class="Apple-converted-space">  </span>[[0.0, 0.0, 1.0, 0, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0, 0.0, 0.0, 1.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.38, 0.0, 0.23, 0.38, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.31, 0.0, 0.69, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.75, 0.0, 0.25, 0.0]]</span></p>
<p class="p8"><span class="s1">B =<span class="Apple-converted-space">  </span>[[0.0, 0.0, 1.0, 0.0, 0.0, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.6, 0.2, 0.2, 0.0, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 0, 1.0, 0.0, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0, 0.0, 0, 0.22, 0.0, 0.78],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.6, 0.0, 0.0, 0.0, 0.4, 0.0]]</span></p>
<p class="p8"><span class="s1">pi =<span class="Apple-converted-space">  </span>[0.0, 0.0, 1.0, 0.0, 0.0]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">HMM 3:</span></p>
<p class="p8"><span class="s1">A =<span class="Apple-converted-space">  </span>[[0, 0.0, 0.32, 0.18, 0.5],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 0.0, 1.0, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0, 0.0, 0, 0.0, 1.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0, 0.64, 0, 0.0, 0.36],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[1.0, 0.0, 0, 0, 0]]</span></p>
<p class="p8"><span class="s1">B =<span class="Apple-converted-space">  </span>[[0.0, 0.17, 0.33, 0.0, 0.0, 0.5],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 0.0, 1.0, 0.0, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.47, 0.0, 0.0, 0.0, 0.0, 0.53],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.27, 0.0, 0.0, 0.0, 0.73, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.66, 0.0, 0.0, 0.33, 0.0, 0.0]]</span></p>
<p class="p8"><span class="s1">pi =<span class="Apple-converted-space">  </span>[0.0, 0.0, 0.0, 1.0, 0.0]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">HMM 4:</span></p>
<p class="p8"><span class="s1">A =<span class="Apple-converted-space">  </span>[[0.0, 0.0, 1.0, 0, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0, 0.62, 0, 0.38],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.5, 0.0, 0.5, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.23, 0.0, 0.0, 0.77],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0, 0, 1.0, 0]]</span></p>
<p class="p8"><span class="s1">B =<span class="Apple-converted-space">  </span>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 0.62, 0, 0.38, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0, 0.0, 0.0, 0.0, 1, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0, 0.0, 0, 0.41, 0.18, 0.41],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.31, 0.16, 0.37, 0.16, 0, 0.0]]</span></p>
<p class="p8"><span class="s1">pi =<span class="Apple-converted-space">  </span>[1.0, 0.0, 0.0, 0.0, 0]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">HMM 5:</span></p>
<p class="p8"><span class="s1">A =<span class="Apple-converted-space">  </span>[[0.5, 0.33, 0, 0.17, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 0.0, 0.0, 1.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.75, 0.0, 0.25, 0.0, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 0, 1.0, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 1.0, 0.0, 0.0]]</span></p>
<p class="p8"><span class="s1">B =<span class="Apple-converted-space">  </span>[[0.0, 0.0, 0.0, 0.0, 1.0, 0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 1.0, 0.0, 0.0, 0.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 0.0, 0.0, 0, 1.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[0.0, 0.0, 0.0, 0.0, 0, 1.0],</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">      </span>[1.0, 0.0, 0.0, 0.0, 0.0, 0.0]]</span></p>
<p class="p8"><span class="s1">pi =<span class="Apple-converted-space">  </span>[0.0, 1.0, 0.0, 0.0, 0.0]</span></p>
<p class="p12"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Result</span></p>
<p class="p13"><span class="s1">Observation Sequence<span class="Apple-tab-span">	</span>HMM 1<span class="Apple-tab-span">	</span>HMM 2<span class="Apple-tab-span">	</span>HMM 3<span class="Apple-tab-span">	</span>HMM 4<span class="Apple-tab-span">	</span>HMM 5</span></p>
<p class="p13"><span class="s1">O1<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-28.46<span class="Apple-tab-span">	</span>-inf *<span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span></span></p>
<p class="p13"><span class="s1">O2<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-28.63<span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span></span></p>
<p class="p13"><span class="s1">O3<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-30.97<span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span></span></p>
<p class="p13"><span class="s1">O4<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-34.74<span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span></span></p>
<p class="p13"><span class="s1">O5<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-inf<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-12.00<span class="Apple-tab-span">	</span></span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p2"><span class="s1">Code</span></p>
<p class="p8"><span class="s1">//<span class="Apple-converted-space"> </span></span></p>
<p class="p14"><span class="s10">import</span><span class="s11"> </span><span class="s1">numpy</span><span class="s11"> </span><span class="s12">as</span><span class="s11"> </span><span class="s1">np</span></p>
<p class="p19"><span class="s10">from</span><span class="s11"> </span><span class="s14">__future__</span><span class="s11"> </span><span class="s10">import</span><span class="s11"> </span><span class="s1">absolute_import</span></p>
<p class="p14"><span class="s10">from</span><span class="s11"> </span><span class="s1">__future__</span><span class="s11"> </span><span class="s10">import</span><span class="s11"> </span><span class="s17">division</span></p>
<p class="p19"><span class="s10">from</span><span class="s11"> </span><span class="s14">__future__</span><span class="s11"> </span><span class="s10">import</span><span class="s11"> </span><span class="s1">print_function</span></p>
<p class="p17"><span class="s1">import</span><span class="s11"> </span><span class="s14">math</span><span class="s11"> </span><span class="s12">as</span><span class="s11"> </span><span class="s14">m</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p18"><span class="s12">def</span><span class="s11"> </span><span class="s1">safelog2</span><span class="s11">(</span><span class="s17">x</span><span class="s11">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s20">"""</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">    </span>Computes the logarithm base 2 of the number x.</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">    </span>Returns negative infinity when x is zero.</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">    </span>"""</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">if</span><span class="s1"> </span><span class="s17">x</span><span class="s1"> == </span><span class="s16">0</span><span class="s1">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> -</span><span class="s14">float</span><span class="s1">(</span><span class="s20">'inf'</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s10">else</span><span class="s1">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s14">m</span><span class="s1">.</span><span class="s15">log</span><span class="s1">(</span><span class="s17">x</span><span class="s1">, </span><span class="s16">2</span><span class="s1">)</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p14"><span class="s12">class</span><span class="s11"> </span><span class="s1">hmm_t</span><span class="s11">(</span><span class="s1">object</span><span class="s11">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s20">"""</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">    </span>This class specifies an HMM that is described by its state transition</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">    </span>probability matrix A, the observation probability matrix B, and the initial</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">    </span>state probability vector pi.</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">    </span>"""</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s12">def</span><span class="s1"> </span><span class="s15">__init__</span><span class="s1">(</span><span class="s17">self</span><span class="s1">, </span><span class="s17">A</span><span class="s1">, </span><span class="s17">B</span><span class="s1">, </span><span class="s17">pi</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s20">"""</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">        </span>Initializes a new hmm_t object given the state transition probability</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">        </span>matrix A, the observation probability matrix B, and the vector of</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">        </span>initial state probabilities pi.</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">        </span>"""</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s15">len</span><span class="s1">(</span><span class="s17">A</span><span class="s1">) != </span><span class="s15">len</span><span class="s1">(</span><span class="s17">B</span><span class="s1">) </span><span class="s12">or</span><span class="s1"> </span><span class="s15">len</span><span class="s1">(</span><span class="s17">A</span><span class="s1">) != </span><span class="s15">len</span><span class="s1">(</span><span class="s17">pi</span><span class="s1">):</span></p>
<p class="p20"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s10">raise</span><span class="s11"> </span><span class="s14">ValueError</span><span class="s11">(</span><span class="s1">"inconsistent number of states"</span><span class="s11">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s15">len</span><span class="s1">(</span><span class="s17">B</span><span class="s1">) == </span><span class="s16">0</span><span class="s1"> </span><span class="s12">or</span><span class="s1"> </span><span class="s15">any</span><span class="s1">(</span><span class="s17">_</span><span class="s1">.shape != </span><span class="s17">B</span><span class="s1">[</span><span class="s16">0</span><span class="s1">].shape </span><span class="s10">for</span><span class="s1"> </span><span class="s17">_</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s17">B</span><span class="s1">):</span></p>
<p class="p20"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s10">raise</span><span class="s11"> </span><span class="s14">ValueError</span><span class="s11">(</span><span class="s1">"inconsistent alphabet size"</span><span class="s11">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">self</span><span class="s1">.</span><span class="s17">A</span><span class="s1"> = </span><span class="s17">A</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">self</span><span class="s1">.</span><span class="s17">B</span><span class="s1"> = </span><span class="s17">B</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">self</span><span class="s1">.</span><span class="s17">pi</span><span class="s1"> = </span><span class="s17">pi</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p14"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s15">@</span><span class="s1">property</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s12">def</span><span class="s1"> </span><span class="s17">N</span><span class="s1">(</span><span class="s17">self</span><span class="s1">):</span></p>
<p class="p20"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1">""" Gets the value of N, i.e., the number of states in the hmm. """</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s15">len</span><span class="s1">(</span><span class="s17">self</span><span class="s1">.</span><span class="s17">A</span><span class="s1">)</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p14"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s15">@</span><span class="s1">property</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s12">def</span><span class="s1"> </span><span class="s17">M</span><span class="s1">(</span><span class="s17">self</span><span class="s1">):</span></p>
<p class="p20"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1">""" Gets the value of M, i.e., the size of the alphabet. """</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s15">len</span><span class="s1">(</span><span class="s17">self</span><span class="s1">.</span><span class="s17">B</span><span class="s1">[</span><span class="s16">0</span><span class="s1">])</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p14"><span class="s12">class</span><span class="s11"> </span><span class="s1">forward_t</span><span class="s11">(</span><span class="s1">object</span><span class="s11">):</span></p>
<p class="p20"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1">""" This class implements the Forward algorithm. """</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s12">def</span><span class="s1"> </span><span class="s15">__init__</span><span class="s1">(</span><span class="s17">self</span><span class="s1">, </span><span class="s17">lambda_</span><span class="s1">, </span><span class="s17">T</span><span class="s1">=</span><span class="s12">None</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s20">"""</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">        </span>Initializes a new `forward_t` instance using an `hmm_t` object and,</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">        </span>optionally, the sequence length T.</span></p>
<p class="p20"><span class="s1"><span class="Apple-converted-space">        </span>"""</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1">self</span><span class="s11">.</span><span class="s1">lambda_</span><span class="s11"> = </span><span class="s1">lambda_</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s17">T</span><span class="s1">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">self</span><span class="s1">.</span><span class="s17">alpha</span><span class="s1"> = [[</span><span class="s12">None</span><span class="s1">]*</span><span class="s17">T</span><span class="s1"> </span><span class="s10">for</span><span class="s1"> </span><span class="s17">_</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s17">lambda_</span><span class="s1">.N)]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">self</span><span class="s1">.</span><span class="s17">c</span><span class="s1"> = [</span><span class="s12">None</span><span class="s1">]*</span><span class="s17">T</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">else</span><span class="s1">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">self</span><span class="s1">.</span><span class="s17">alpha</span><span class="s1"> = </span><span class="s17">self</span><span class="s1">.</span><span class="s17">c</span><span class="s1"> = </span><span class="s12">None</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s12">def</span><span class="s1"> </span><span class="s15">__call__</span><span class="s1">(</span><span class="s17">self</span><span class="s1">, </span><span class="s17">O</span><span class="s1">):</span></p>
<p class="p20"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1">""" Calls the Forward algorithm. """</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s13">T</span><span class="s1"> = </span><span class="s15">len</span><span class="s1">(</span><span class="s17">O</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">h</span><span class="s1"> = </span><span class="s17">self</span><span class="s1">.</span><span class="s17">lambda_</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s13">N</span><span class="s1"> = </span><span class="s17">h</span><span class="s1">.N</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s13">M</span><span class="s1"> = </span><span class="s17">h</span><span class="s1">.M</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s12">not</span><span class="s1"> </span><span class="s17">self</span><span class="s1">.</span><span class="s17">alpha</span><span class="s1"> </span><span class="s12">or</span><span class="s1"> </span><span class="s13">T</span><span class="s1"> &gt; </span><span class="s15">len</span><span class="s1">(</span><span class="s17">self</span><span class="s1">.</span><span class="s17">alpha</span><span class="s1">[</span><span class="s16">0</span><span class="s1">]):<span class="Apple-converted-space">  </span></span><span class="s22"># resize if necessary</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">self</span><span class="s1">.</span><span class="s17">alpha</span><span class="s1"> = [[</span><span class="s12">None</span><span class="s1">]*</span><span class="s13">T</span><span class="s1"> </span><span class="s10">for</span><span class="s1"> </span><span class="s17">_</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">N</span><span class="s1">)]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s12">not</span><span class="s1"> </span><span class="s17">self</span><span class="s1">.</span><span class="s17">c</span><span class="s1"> </span><span class="s12">or</span><span class="s1"> </span><span class="s13">T</span><span class="s1"> &gt; </span><span class="s15">len</span><span class="s1">(</span><span class="s17">self</span><span class="s1">.</span><span class="s17">c</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">self</span><span class="s1">.</span><span class="s17">c</span><span class="s1"> = [</span><span class="s12">None</span><span class="s1">]*</span><span class="s13">T</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1">alpha</span><span class="s11"> = </span><span class="s1">self</span><span class="s11">.</span><span class="s1">alpha</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">c</span><span class="s1"> = </span><span class="s17">self</span><span class="s1">.</span><span class="s17">c</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">logL</span><span class="s1"> = </span><span class="s16">0</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">T</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">assert</span><span class="s1"> </span><span class="s17">O</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">M</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">c</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s16">0</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">i</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">N</span><span class="s1">):</span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">                </span></span><span class="s1"># Use pi instead of the recursive formula if t is zero.</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">if</span><span class="s1"> </span><span class="s16">0</span><span class="s1"> == </span><span class="s17">t</span><span class="s1">:</span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">                    </span></span><span class="s1"># Compute the alphas before renormalizing.</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">i</span><span class="s1">][</span><span class="s16">0</span><span class="s1">] = </span><span class="s17">h</span><span class="s1">.pi[</span><span class="s17">i</span><span class="s1">] * </span><span class="s17">h</span><span class="s1">.B[</span><span class="s17">i</span><span class="s1">][</span><span class="s17">O</span><span class="s1">[</span><span class="s16">0</span><span class="s1">]]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">else</span><span class="s1">:</span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">                    </span></span><span class="s1"># Use the recursive formula to compute alpha at time t in</span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">                    </span></span><span class="s1"># terms of alphas at time t-1.</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">i</span><span class="s1">][</span><span class="s17">t</span><span class="s1">] = </span><span class="s16">0</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">j</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">N</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">i</span><span class="s1">][</span><span class="s17">t</span><span class="s1">] += </span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">j</span><span class="s1">][</span><span class="s17">t</span><span class="s1">-</span><span class="s16">1</span><span class="s1">] * </span><span class="s17">h</span><span class="s1">.A[</span><span class="s17">j</span><span class="s1">][</span><span class="s17">i</span><span class="s1">] * </span><span class="s17">h</span><span class="s1">.B[</span><span class="s17">i</span><span class="s1">][</span><span class="s17">O</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]]</span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">                </span></span><span class="s17">c</span><span class="s11">[</span><span class="s17">t</span><span class="s11">] += </span><span class="s17">alpha</span><span class="s11">[</span><span class="s17">i</span><span class="s11">][</span><span class="s17">t</span><span class="s11">]<span class="Apple-converted-space">  </span></span><span class="s1"># update the re-normalization coefficient</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">if</span><span class="s1"> </span><span class="s17">c</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] == </span><span class="s16">0</span><span class="s1"> </span><span class="s12">or</span><span class="s1"> </span><span class="s14">float</span><span class="s1">(</span><span class="s20">'inf'</span><span class="s1">) == </span><span class="s16">1.0</span><span class="s1">/</span><span class="s17">c</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]:</span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">                </span></span><span class="s17">c</span><span class="s11">[</span><span class="s17">t</span><span class="s11">] = </span><span class="s16">1.0</span><span class="s11"><span class="Apple-converted-space">  </span></span><span class="s1"># set c's to 1s to avoid NaNs</span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">                </span></span><span class="s1"># Set the log-likelihood to -inf to indicate that the sequence</span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">                </span></span><span class="s1"># is improbable. Otherwise, compute the renormalization</span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">                </span></span><span class="s1"># coefficient c[t] as usual.</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s17">logL</span><span class="s1"> = -</span><span class="s14">float</span><span class="s1">(</span><span class="s20">'inf'</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">else</span><span class="s1">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s17">c</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s16">1.0</span><span class="s1">/</span><span class="s17">c</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">i</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s13">N</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">i</span><span class="s1">][</span><span class="s17">t</span><span class="s1">] *= </span><span class="s17">c</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]<span class="Apple-converted-space">  </span></span><span class="s22"># renormalize the alphas</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s17">logL</span><span class="s1"> -= </span><span class="s15">safelog2</span><span class="s1">(</span><span class="s17">c</span><span class="s1">[</span><span class="s17">t</span><span class="s1">])</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">return</span><span class="s1"> </span><span class="s17">logL</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define the observation sequences</span></p>
<p class="p13"><span class="s13">O1</span><span class="s1"> = [</span><span class="s16">4</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">1</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">1</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">1</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">1</span><span class="s1">]</span></p>
<p class="p13"><span class="s13">O2</span><span class="s1"> = [</span><span class="s16">3</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">1</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">1</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">1</span><span class="s1">,</span><span class="s16">0</span><span class="s1">]</span></p>
<p class="p13"><span class="s13">O3</span><span class="s1"> = [</span><span class="s16">4</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">1</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">4</span><span class="s1">]</span></p>
<p class="p13"><span class="s13">O4</span><span class="s1"> = [</span><span class="s16">3</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">1</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">3</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">4</span><span class="s1">]</span></p>
<p class="p13"><span class="s13">O5</span><span class="s1"> = [</span><span class="s16">2</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">2</span><span class="s1">,</span><span class="s16">0</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">4</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">5</span><span class="s1">,</span><span class="s16">5</span><span class="s1">]</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define the HMMs</span></p>
<p class="p13"><span class="s13">A1</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.33</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.67</span><span class="s1">, </span><span class="s16">0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0.67</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.33</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.25</span><span class="s1">, </span><span class="s16">0.75</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.6</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.4</span><span class="s1">]])</span></p>
<p class="p13"><span class="s13">B1</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.67</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.33</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0.5</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.5</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.25</span><span class="s1">, </span><span class="s16">0.75</span><span class="s1">, </span><span class="s16">0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.6</span><span class="s1">, </span><span class="s16">0.4</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">]])</span></p>
<p class="p13"><span class="s17">pi1</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">])</span></p>
<p class="p13"><span class="s17">hmm1</span><span class="s1"> = </span><span class="s14">hmm_t</span><span class="s1">(</span><span class="s13">A1</span><span class="s1">, </span><span class="s13">B1</span><span class="s1">, </span><span class="s17">pi1</span><span class="s1">)</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s13">A2</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0.38</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.23</span><span class="s1">, </span><span class="s16">0.38</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.31</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.69</span><span class="s1">, </span><span class="s16">0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.75</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.25</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">]])</span></p>
<p class="p13"><span class="s13">B2</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.6</span><span class="s1">, </span><span class="s16">0.2</span><span class="s1">, </span><span class="s16">0.2</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.22</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.78</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">               </span>[</span><span class="s16">0.6</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.4</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">]])</span></p>
<p class="p13"><span class="s17">pi2</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">])</span></p>
<p class="p13"><span class="s17">hmm2</span><span class="s1"> = </span><span class="s14">hmm_t</span><span class="s1">(</span><span class="s13">A2</span><span class="s1">, </span><span class="s13">B2</span><span class="s1">, </span><span class="s17">pi2</span><span class="s1">)</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s13">A3</span><span class="s1"> =<span class="Apple-converted-space">  </span></span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.32</span><span class="s1">, </span><span class="s16">0.18</span><span class="s1">, </span><span class="s16">0.5</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.64</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.36</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">]])</span></p>
<p class="p13"><span class="s13">B3</span><span class="s1"> =<span class="Apple-converted-space">  </span></span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.17</span><span class="s1">, </span><span class="s16">0.33</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.5</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p22"><span class="s11"><span class="Apple-converted-space">      </span>[</span><span class="s1">0.47</span><span class="s11">, </span><span class="s1">0.0</span><span class="s11">, </span><span class="s1">0.0</span><span class="s11">, </span><span class="s1">0.0</span><span class="s11">, </span><span class="s1">0.0</span><span class="s11">, </span><span class="s1">0.53</span><span class="s11">],</span></p>
<p class="p22"><span class="s11"><span class="Apple-converted-space">      </span>[</span><span class="s1">0.27</span><span class="s11">, </span><span class="s1">0.0</span><span class="s11">, </span><span class="s1">0.0</span><span class="s11">, </span><span class="s1">0.0</span><span class="s11">, </span><span class="s1">0.73</span><span class="s11">, </span><span class="s1">0.0</span><span class="s11">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.66</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.33</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">]])</span></p>
<p class="p13"><span class="s17">pi3</span><span class="s1"> =<span class="Apple-converted-space">  </span></span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">])</span></p>
<p class="p13"><span class="s17">hmm3</span><span class="s1"> = </span><span class="s14">hmm_t</span><span class="s1">(</span><span class="s13">A3</span><span class="s1">, </span><span class="s13">B3</span><span class="s1">, </span><span class="s17">pi3</span><span class="s1">)</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s13">A4</span><span class="s1"> =<span class="Apple-converted-space">  </span></span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.62</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.38</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.5</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.5</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.23</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.77</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">]])</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s13">B4</span><span class="s1"> =<span class="Apple-converted-space">  </span></span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.62</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.38</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1</span><span class="s1">, </span><span class="s16">0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.41</span><span class="s1">, </span><span class="s16">0.18</span><span class="s1">, </span><span class="s16">0.41</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.31</span><span class="s1">, </span><span class="s16">0.16</span><span class="s1">, </span><span class="s16">0.37</span><span class="s1">, </span><span class="s16">0.16</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">]])</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s17">pi4</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">])</span></p>
<p class="p13"><span class="s17">hmm4</span><span class="s1"> = </span><span class="s14">hmm_t</span><span class="s1">(</span><span class="s13">A4</span><span class="s1">, </span><span class="s13">B4</span><span class="s1">, </span><span class="s17">pi4</span><span class="s1">)</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s13">A5</span><span class="s1"> =<span class="Apple-converted-space">  </span></span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.5</span><span class="s1">, </span><span class="s16">0.33</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">0.17</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.75</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.25</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">]])</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s13">B5</span><span class="s1"> =<span class="Apple-converted-space">  </span></span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">],</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">      </span>[</span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">]])</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p13"><span class="s17">pi5</span><span class="s1"> =<span class="Apple-converted-space">  </span></span><span class="s14">np</span><span class="s1">.</span><span class="s15">array</span><span class="s1">([</span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">1.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">, </span><span class="s16">0.0</span><span class="s1">])</span></p>
<p class="p13"><span class="s17">hmm5</span><span class="s1"> = </span><span class="s14">hmm_t</span><span class="s1">(</span><span class="s13">A5</span><span class="s1">, </span><span class="s13">B5</span><span class="s1">, </span><span class="s17">pi5</span><span class="s1">)</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Compute likelihoods for each HMM and each sequence</span></p>
<p class="p19"><span class="s1">HMMs</span><span class="s11"> = [</span><span class="s1">hmm1</span><span class="s11">, </span><span class="s1">hmm2</span><span class="s11">, </span><span class="s1">hmm3</span><span class="s11">, </span><span class="s1">hmm4</span><span class="s11">, </span><span class="s1">hmm5</span><span class="s11">]</span></p>
<p class="p13"><span class="s17">Os</span><span class="s1"> = [</span><span class="s13">O1</span><span class="s1">, </span><span class="s13">O2</span><span class="s1">, </span><span class="s13">O3</span><span class="s1">, </span><span class="s13">O4</span><span class="s1">, </span><span class="s13">O5</span><span class="s1">]</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p20"><span class="s15">print</span><span class="s11">(</span><span class="s1">"Here are the log-likelihood values for each observation sequence given each HMM:"</span><span class="s11">)</span></p>
<p class="p20"><span class="s15">print</span><span class="s11">(</span><span class="s1">"Observation Sequence</span><span class="s23">\t</span><span class="s1">HMM 1</span><span class="s23">\t</span><span class="s1">HMM 2</span><span class="s23">\t</span><span class="s1">HMM 3</span><span class="s23">\t</span><span class="s1">HMM 4</span><span class="s23">\t</span><span class="s1">HMM 5"</span><span class="s11">)</span></p>
<p class="p19"><span class="s1">hmm_list</span><span class="s11"> = [</span><span class="s1">hmm1</span><span class="s11">, </span><span class="s1">hmm2</span><span class="s11">, </span><span class="s1">hmm3</span><span class="s11">, </span><span class="s1">hmm4</span><span class="s11">, </span><span class="s1">hmm5</span><span class="s11">]</span></p>
<p class="p13"><span class="s17">obs_list</span><span class="s1"> = [</span><span class="s13">O1</span><span class="s1">, </span><span class="s13">O2</span><span class="s1">, </span><span class="s13">O3</span><span class="s1">, </span><span class="s13">O4</span><span class="s1">, </span><span class="s13">O5</span><span class="s1">]</span></p>
<p class="p19"><span class="s10">for</span><span class="s11"> </span><span class="s1">i</span><span class="s11">, </span><span class="s1">obs</span><span class="s11"> </span><span class="s12">in</span><span class="s11"> </span><span class="s14">enumerate</span><span class="s11">(</span><span class="s1">obs_list</span><span class="s11">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s15">print</span><span class="s1">(f</span><span class="s20">"O{</span><span class="s17">i</span><span class="s20">+1}</span><span class="s23">\t</span><span class="s20">"</span><span class="s1">, </span><span class="s17">end</span><span class="s1">=</span><span class="s20">""</span><span class="s1">)</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s10">for</span><span class="s11"> </span><span class="s1">hmm</span><span class="s11"> </span><span class="s12">in</span><span class="s11"> </span><span class="s1">hmm_list</span><span class="s11">:</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1">forward_algo</span><span class="s11"> = </span><span class="s14">forward_t</span><span class="s11">(</span><span class="s1">hmm</span><span class="s11">)</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1">log_likelihood</span><span class="s11"> = </span><span class="s1">forward_algo</span><span class="s11">(</span><span class="s1">obs</span><span class="s11">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s1"> </span><span class="s17">hmm</span><span class="s1"> == </span><span class="s17">hmm2</span><span class="s1"> </span><span class="s12">and</span><span class="s1"> </span><span class="s17">obs</span><span class="s1"> == </span><span class="s13">O1</span><span class="s1">:</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s15">print</span><span class="s11">(f</span><span class="s20">"</span><span class="s1">{log_likelihood:.2f}</span><span class="s20"> *</span><span class="s23">\t</span><span class="s20">"</span><span class="s11">, </span><span class="s1">end</span><span class="s11">=</span><span class="s20">""</span><span class="s11">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">else</span><span class="s1">:</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s15">print</span><span class="s11">(f</span><span class="s20">"</span><span class="s1">{log_likelihood:.2f}</span><span class="s23">\t</span><span class="s20">"</span><span class="s11">, </span><span class="s1">end</span><span class="s11">=</span><span class="s20">""</span><span class="s11">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s15">print</span><span class="s1">()</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">      </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 10: Train HMMs (using the <a href="https://github.com/sukhoy/nanohmm"><span class="s21">NanoHMM</span></a> library)</span></h2>
<p class="p4"><span class="s1">For part 10, the model lambda=(A,B,pi) is not provided so you need to start with random values and iterate until convergence. Then restart with another set of random values and repeat the process. From all models that converged, you need to pick the best one. See the library for an example.</span></p>
<p class="p4"><span class="s1">The following five observation sequences are used for both parts 10A and 10B:</span></p>
<p class="p8"><span class="s1">O1 = (4,2,5,1,5,1,5,3,2,3,2,0,1,0,0,4,4,3,0,1)</span></p>
<p class="p8"><span class="s1">O2 = (3,2,3,3,5,5,5,5,1,0,1,4,2,4,3,0,5,3,1,0)</span></p>
<p class="p8"><span class="s1">O3 = (4,3,0,3,4,0,1,0,2,0,5,3,2,0,0,5,5,3,5,4)</span></p>
<p class="p8"><span class="s1">O4 = (3,4,2,0,5,4,4,3,1,5,3,3,2,3,0,4,2,5,2,4)</span></p>
<p class="p8"><span class="s1">O5 = (2,0,5,4,4,2,0,5,5,4,4,2,0,5,4,4,5,5,5,5)</span></p>
<p class="p12"><span class="s1"></span><br></p>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; font: 14.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 10A: Train 3-State HMMs</span></h3>
<p class="p4"><span class="s1">Train a 3-state HMM for each of the five observation sequences using the Baum-Welch implementation in the <a href="https://github.com/sukhoy/nanohmm"><span class="s6">NanoHMM</span></a> library.</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Best model for observation sequence 1:</span></p>
<p class="p2"><span class="s1">A = [[2.43085720e-36 2.07440558e-47 1.00000000e+00]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[2.50000151e-01 6.72183684e-10 7.49999848e-01]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[6.07511973e-07 9.99999392e-01 1.45442049e-13]]</span></p>
<p class="p2"><span class="s1">B = [[5.84401083e-43 6.43586311e-10 2.96950103e-98 3.33334413e-01</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>6.66665587e-01 9.57529237e-52]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[3.75000228e-01 2.23642614e-70 5.44442257e-12 1.24999469e-01</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>1.25000076e-01 3.75000228e-01]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[1.11111111e-01 4.44444444e-01 3.33333333e-01 1.11111111e-01</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>1.26354429e-58 3.74243509e-78]]</span></p>
<p class="p2"><span class="s1">pi = [1.00000000e+00 8.04778126e-18 0.00000000e+00]</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Best model for observation sequence 2:</span></p>
<p class="p2"><span class="s1">A = [[7.26782717e-08 5.71428651e-01 4.28571276e-01]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[9.99999915e-01 8.48046705e-08 4.53142466e-17]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[1.72150121e-08 9.99999983e-01 1.05875621e-20]]</span></p>
<p class="p2"><span class="s1">B = [[2.49999943e-01 2.06326887e-26 1.09593876e-40 1.25000093e-01</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>2.49999998e-01 3.74999967e-01]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[1.25000043e-01 3.74999966e-01 2.49999977e-01 6.11504821e-09</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>1.42408983e-33 2.50000007e-01]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[4.55656867e-20 1.17825889e-24 1.55449566e-26 1.00000000e+00</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>1.62598369e-24 5.38443614e-15]]</span></p>
<p class="p2"><span class="s1">pi = [3.19595020e-15 4.84274303e-48 1.00000000e+00]</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Best model for observation sequence 3:</span></p>
<p class="p2"><span class="s1">A = [[3.31734837e-309 1.00000000e+000 1.31863154e-102]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[9.83303759e-009 6.66664184e-001 3.33335807e-001]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[4.28570852e-001 2.58019229e-026 5.71429148e-001]]</span></p>
<p class="p2"><span class="s1">B = [[7.52156617e-180 4.28482085e-156 2.50001712e-001 2.14594889e-019</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>7.49998288e-001 7.69861356e-039]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[6.66666211e-001 1.11111601e-001 1.11110586e-001 1.11111603e-001</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>4.74741121e-040 9.53379051e-011]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[4.36222155e-006 9.34334834e-116 1.33894285e-115 4.28569558e-001</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>1.16298536e-022 5.71426080e-001]]</span></p>
<p class="p2"><span class="s1">pi = [1. 0. 0.]</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Best model for observation sequence 4:</span></p>
<p class="p2"><span class="s1">A = [[4.15287286e-34 6.77630543e-15 1.00000000e+00]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[1.83376208e-01 8.16621914e-01 1.87784966e-06]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[6.66557797e-01 3.33442203e-01 5.77319491e-12]]</span></p>
<p class="p2"><span class="s1">B = [[3.41429995e-076 0.00000000e+000 1.67352150e-001 6.28954019e-001</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>1.22634676e-015 2.03693831e-001]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[3.87898676e-010 6.28886383e-129 2.61688403e-001 1.44937861e-030</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>5.04184130e-001 2.34127466e-001]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[3.14476420e-001 1.57238210e-001 1.62028997e-001 1.57238210e-001</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>2.09018163e-001 1.05502697e-039]]</span></p>
<p class="p2"><span class="s1">pi = [1.00000000e+00 0.00000000e+00 1.35395276e-52]</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Best model for observation sequence 5:</span></p>
<p class="p2"><span class="s1">A = [[4.70019962e-10 1.00000000e+00 8.55465351e-45]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[5.04603813e-13 8.46153716e-01 1.53846284e-01]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[1.00000000e+00 4.31579616e-33 1.63005389e-38]]</span></p>
<p class="p2"><span class="s1">B = [[9.99999999e-001 0.00000000e+000 3.34487102e-038 0.00000000e+000</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>1.31563309e-020 5.31731196e-010]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[5.53619211e-107 0.00000000e+000 1.73211396e-030 0.00000000e+000</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>4.28571480e-001 5.71428520e-001]</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span>[1.04326450e-096 0.00000000e+000 9.99999437e-001 0.00000000e+000</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span>1.63136778e-016 5.62843961e-007]]</span></p>
<p class="p2"><span class="s1">pi = [4.20624583e-141 1.58911669e-134 1.00000000e+000]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; font: 14.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part 10B: Train 4-State HMMs</span></h3>
<p class="p4"><span class="s1">Train a 4-state HMM for each of the five observation sequences using the Baum-Welch implementation in the <a href="https://github.com/sukhoy/nanohmm"><span class="s6">NanoHMM</span></a> library.</span></p>
<p class="p2"><span class="s1">Result</span></p>
<p class="p8"><span class="s1">Best model for observation sequence 1:</span></p>
<p class="p8"><span class="s1">A = [[6.66666664e-001 4.35649392e-097 6.54733486e-055 3.33333336e-001]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[3.72025931e-176 0.00000000e+000 6.66667484e-001 3.33332516e-001]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[6.66666105e-001 8.17044433e-007 3.33333078e-001 2.91412301e-132]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[1.78978098e-013 1.00000000e+000 6.46173799e-012 2.37377704e-141]]</span></p>
<p class="p8"><span class="s1">B = [[2.87246058e-010 1.32012868e-106 3.33333336e-001 3.33333328e-001</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>3.33333335e-001 6.56648780e-231]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[7.09347529e-098 1.00000000e+000 5.61242091e-212 2.55585770e-242</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>3.13785185e-147 0.00000000e+000]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[6.66666104e-001 2.87261678e-023 3.00981337e-092 2.36639749e-008</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>2.88466323e-009 3.33333869e-001]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[5.00000306e-001 1.50343967e-102 1.25467194e-133 2.22924816e-135</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>1.61807102e-140 4.99999694e-001]]</span></p>
<p class="p8"><span class="s1">pi = [1.00000000e+000 0.00000000e+000 4.07177859e-107 0.00000000e+000]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">Best model for observation sequence 2:</span></p>
<p class="p8"><span class="s1">A = [[7.49999859e-001 5.18884249e-116 2.50000141e-001 1.89745082e-120]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[3.00235765e-110 8.59154473e-174 8.59448636e-036 1.00000000e+000]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[4.84883443e-055 3.21349141e-073 7.50000141e-001 2.49999859e-001]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[2.87064568e-109 1.00000000e+000 8.05620142e-024 6.09253461e-022]]</span></p>
<p class="p8"><span class="s1">B = [[0.00000000e+000 0.00000000e+000 2.50000141e-001 7.49999859e-001</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>0.00000000e+000 6.32724073e-012]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[5.00000000e-001 0.00000000e+000 0.00000000e+000 1.66666667e-001</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>3.33333333e-001 1.48872485e-015]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[5.07623776e-131 9.69609741e-214 5.99783090e-078 5.64193714e-007</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>3.18556993e-155 9.99999436e-001]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[1.49070891e-145 5.00000000e-001 1.66666667e-001 1.66666667e-001</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>9.34192750e-295 1.66666667e-001]]</span></p>
<p class="p8"><span class="s1">pi = [1.00000000e+000 3.79200740e-142 7.33895931e-187 1.00106880e-288]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">Best model for observation sequence 3:</span></p>
<p class="p8"><span class="s1">A = [[6.37656852e-009 1.08626384e-017 4.28866945e-007 9.99999565e-001]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[1.00000000e+000 1.26830426e-031 4.19568237e-110 6.57940649e-043]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[2.80635402e-051 1.00000000e+000 0.00000000e+000 5.14113560e-018]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[5.08372546e-001 3.79659452e-069 4.91627453e-001 1.57697723e-010]]</span></p>
<p class="p8"><span class="s1">B = [[2.84346247e-001 1.42173123e-001 8.31993057e-025 7.54638203e-047</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>1.46961260e-001 4.26519370e-001]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[1.00000000e+000 2.30890751e-119 3.60754815e-195 9.64080407e-112</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>1.63485791e-112 2.23575139e-082]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[2.06004165e-128 1.43774520e-145 6.74234988e-001 7.19171526e-131</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>3.25765012e-001 4.06207320e-122]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[1.46961318e-001 4.22406894e-093 1.69877607e-104 5.68692744e-001</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>1.42172751e-001 1.42173186e-001]]</span></p>
<p class="p8"><span class="s1">pi = [1.00000000e+000 0.00000000e+000 1.75402719e-120 9.26107521e-076]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">Best model for observation sequence 4:</span></p>
<p class="p8"><span class="s1">A = [[9.91758545e-028 0.00000000e+000 5.72240694e-001 4.27759306e-001]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[1.00000000e+000 0.00000000e+000 0.00000000e+000 3.99840801e-216]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[3.99270011e-001 6.00728638e-001 7.48176210e-176 1.35101387e-006]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[2.02344646e-023 1.77809223e-001 1.64323124e-029 8.22190777e-001]]</span></p>
<p class="p8"><span class="s1">B = [[3.85760726e-001 1.92880363e-001 1.12770568e-115 1.92880363e-001</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>2.28478548e-001 0.00000000e+000]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[0.00000000e+000 0.00000000e+000 9.37636935e-035 1.00000000e+000</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>2.03215387e-034 4.68908180e-259]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[3.11153275e-061 1.23063463e-242 6.46034843e-001 7.87934204e-150</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>1.59303437e-007 3.53964998e-001]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[3.65686328e-015 1.08374633e-173 2.65439325e-001 2.68804135e-078</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>4.86128448e-001 2.48432227e-001]]</span></p>
<p class="p8"><span class="s1">pi = [1.37684014e-243 1.00000000e+000 0.00000000e+000 0.00000000e+000]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">Best model for observation sequence 5:</span></p>
<p class="p8"><span class="s1">A = [[5.71428061e-01 5.84536094e-78 4.28571939e-01 0.00000000e+00]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[0.00000000e+00 0.00000000e+00 0.00000000e+00 1.00000000e+00]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[1.66666832e-01 3.33333278e-01 4.99999891e-01 0.00000000e+00]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[1.00000000e+00 0.00000000e+00 4.07868315e-57 0.00000000e+00]]</span></p>
<p class="p8"><span class="s1">B = [[0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>5.97350253e-07 9.99999403e-01]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[0.00000000e+00 0.00000000e+00 1.00000000e+00 0.00000000e+00</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>0.00000000e+00 7.83665496e-64]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>9.99998706e-01 1.29431812e-06]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space"> </span>[1.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">  </span>0.00000000e+00 0.00000000e+00]]</span></p>
<p class="p8"><span class="s1">pi = [0. 1. 0. 0.]</span></p>
<p class="p8"><span class="s1">...</span></p>
<p class="p2"><span class="s1">Code</span></p>
<p class="p14"><span class="s9">// </span><span class="s10">import</span><span class="s11"> </span><span class="s1">numpy</span><span class="s11"> </span><span class="s12">as</span><span class="s11"> </span><span class="s1">np</span></p>
<p class="p16"><span class="s1"># Define the number of states</span></p>
<p class="p13"><span class="s13">N</span><span class="s1"> = </span><span class="s16">3</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define the number of iterations</span></p>
<p class="p19"><span class="s1">num_iterations</span><span class="s11"> = </span><span class="s16">100</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define the convergence threshold</span></p>
<p class="p19"><span class="s1">threshold</span><span class="s11"> = </span><span class="s16">1e-6</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define the number of random initializations</span></p>
<p class="p19"><span class="s1">num_initializations</span><span class="s11"> = </span><span class="s16">1</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Define the maximum likelihood and corresponding model parameters</span></p>
<p class="p19"><span class="s1">max_likelihoods</span><span class="s11"> = {}</span></p>
<p class="p19"><span class="s1">best_models</span><span class="s11"> = {}</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s1"># Loop over the observation sequences</span></p>
<p class="p13"><span class="s10">for</span><span class="s1"> </span><span class="s17">seq_id</span><span class="s1">, </span><span class="s17">seq</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">enumerate</span><span class="s1">([</span><span class="s13">O1</span><span class="s1">, </span><span class="s13">O2</span><span class="s1">, </span><span class="s13">O3</span><span class="s1">, </span><span class="s13">O4</span><span class="s1">, </span><span class="s13">O5</span><span class="s1">]):</span></p>
<p class="p20"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s15">print</span><span class="s11">(f</span><span class="s1">"Training model for observation sequence {</span><span class="s17">seq_id</span><span class="s1">+1}"</span><span class="s11">)</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1"># Define the maximum number of unique observations among all sequences</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1">num_unique_obs</span><span class="s11"> = </span><span class="s15">len</span><span class="s11">(</span><span class="s14">set</span><span class="s11">(</span><span class="s14">np</span><span class="s11">.</span><span class="s1">concatenate</span><span class="s11">((</span><span class="s13">O1</span><span class="s11">, </span><span class="s13">O2</span><span class="s11">, </span><span class="s13">O3</span><span class="s11">, </span><span class="s13">O4</span><span class="s11">, </span><span class="s13">O5</span><span class="s11">))))</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1"># Define a dictionary to store the best model parameters for this sequence</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1">max_likelihoods</span><span class="s11">[</span><span class="s1">seq_id</span><span class="s11">] = -</span><span class="s14">np</span><span class="s11">.</span><span class="s1">inf</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1">best_models</span><span class="s11">[</span><span class="s1">seq_id</span><span class="s11">] = </span><span class="s12">None</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s1"># Loop over the random initializations</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">    </span></span><span class="s10">for</span><span class="s11"> </span><span class="s1">i</span><span class="s11"> </span><span class="s12">in</span><span class="s11"> </span><span class="s14">range</span><span class="s11">(</span><span class="s1">num_initializations</span><span class="s11">):</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s15">print</span><span class="s11">(f</span><span class="s20">"Initialization {</span><span class="s1">i</span><span class="s20">+1}/</span><span class="s1">{num_initializations}</span><span class="s20">"</span><span class="s11">)</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1"># Initialize the transition matrix, emission matrix, and initial state distribution randomly</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s13">A</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s14">random</span><span class="s1">.</span><span class="s17">rand</span><span class="s1">(</span><span class="s13">N</span><span class="s1">, </span><span class="s13">N</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s13">A</span><span class="s1"> /= </span><span class="s13">A</span><span class="s1">.sum(</span><span class="s17">axis</span><span class="s1">=</span><span class="s16">1</span><span class="s1">, </span><span class="s17">keepdims</span><span class="s1">=</span><span class="s12">True</span><span class="s1">)</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s13">B</span><span class="s11"> = </span><span class="s14">np</span><span class="s11">.</span><span class="s14">random</span><span class="s11">.</span><span class="s1">rand</span><span class="s11">(</span><span class="s13">N</span><span class="s11">, </span><span class="s1">num_unique_obs</span><span class="s11">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s13">B</span><span class="s1"> /= </span><span class="s13">B</span><span class="s1">.sum(</span><span class="s17">axis</span><span class="s1">=</span><span class="s16">1</span><span class="s1">, </span><span class="s17">keepdims</span><span class="s1">=</span><span class="s12">True</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">pi</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s14">random</span><span class="s1">.</span><span class="s17">rand</span><span class="s1">(</span><span class="s13">N</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">pi</span><span class="s1"> /= </span><span class="s17">pi</span><span class="s1">.sum()</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1"># Loop until convergence</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s10">for</span><span class="s11"> </span><span class="s1">j</span><span class="s11"> </span><span class="s12">in</span><span class="s11"> </span><span class="s14">range</span><span class="s11">(</span><span class="s1">num_iterations</span><span class="s11">):</span></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s1"># Calculate the forward and backward probabilities</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">alpha</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">((</span><span class="s15">len</span><span class="s1">(</span><span class="s17">seq</span><span class="s1">), </span><span class="s13">N</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">beta</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">((</span><span class="s15">len</span><span class="s1">(</span><span class="s17">seq</span><span class="s1">), </span><span class="s13">N</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s15">len</span><span class="s1">(</span><span class="s17">seq</span><span class="s1">)):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">if</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> == </span><span class="s16">0</span><span class="s1">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s17">pi</span><span class="s1"> * </span><span class="s13">B</span><span class="s1">[:, </span><span class="s17">seq</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s17">beta</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s16">1</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">else</span><span class="s1">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s13">B</span><span class="s1">[:, </span><span class="s17">seq</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]] * </span><span class="s14">np</span><span class="s1">.</span><span class="s17">dot</span><span class="s1">(</span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">t</span><span class="s1">-</span><span class="s16">1</span><span class="s1">], </span><span class="s13">A</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s17">beta</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s14">np</span><span class="s1">.</span><span class="s17">dot</span><span class="s1">(</span><span class="s17">beta</span><span class="s1">[</span><span class="s17">t</span><span class="s1">-</span><span class="s16">1</span><span class="s1">] * </span><span class="s13">B</span><span class="s1">[:, </span><span class="s17">seq</span><span class="s1">[</span><span class="s15">len</span><span class="s1">(</span><span class="s17">seq</span><span class="s1">)-</span><span class="s16">1</span><span class="s1">-</span><span class="s17">t</span><span class="s1">+</span><span class="s16">1</span><span class="s1">]], </span><span class="s13">A</span><span class="s1">.T)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">beta</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s17">flipud</span><span class="s1">(</span><span class="s17">beta</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">gamma</span><span class="s1"> = </span><span class="s17">alpha</span><span class="s1"> * </span><span class="s17">beta</span><span class="s1"> / </span><span class="s14">np</span><span class="s1">.</span><span class="s15">sum</span><span class="s1">(</span><span class="s17">alpha</span><span class="s1">[-</span><span class="s16">1</span><span class="s1">])</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s1"># Calculate the expected sufficient statistics for the transition matrix</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">xi</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">((</span><span class="s15">len</span><span class="s1">(</span><span class="s17">seq</span><span class="s1">)-</span><span class="s16">1</span><span class="s1">, </span><span class="s13">N</span><span class="s1">, </span><span class="s13">N</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s15">len</span><span class="s1">(</span><span class="s17">seq</span><span class="s1">)-</span><span class="s16">1</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s17">xi</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s17">alpha</span><span class="s1">[</span><span class="s17">t</span><span class="s1">].reshape((-</span><span class="s16">1</span><span class="s1">, </span><span class="s16">1</span><span class="s1">)) * </span><span class="s13">A</span><span class="s1"> * </span><span class="s13">B</span><span class="s1">[:, </span><span class="s17">seq</span><span class="s1">[</span><span class="s17">t</span><span class="s1">+</span><span class="s16">1</span><span class="s1">]].reshape((</span><span class="s16">1</span><span class="s1">, -</span><span class="s16">1</span><span class="s1">)) * </span><span class="s17">beta</span><span class="s1">[</span><span class="s17">t</span><span class="s1">+</span><span class="s16">1</span><span class="s1">].reshape((</span><span class="s16">1</span><span class="s1">, -</span><span class="s16">1</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s17">xi</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] /= </span><span class="s14">np</span><span class="s1">.</span><span class="s15">sum</span><span class="s1">(</span><span class="s17">xi</span><span class="s1">[</span><span class="s17">t</span><span class="s1">])</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s1"># Update the model parameters</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">A_new</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">sum</span><span class="s1">(</span><span class="s17">xi</span><span class="s1">, </span><span class="s17">axis</span><span class="s1">=</span><span class="s16">0</span><span class="s1">) / </span><span class="s14">np</span><span class="s1">.</span><span class="s15">sum</span><span class="s1">(</span><span class="s17">gamma</span><span class="s1">[:-</span><span class="s16">1</span><span class="s1">], </span><span class="s17">axis</span><span class="s1">=</span><span class="s16">0</span><span class="s1">).reshape((-</span><span class="s16">1</span><span class="s1">, </span><span class="s16">1</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">B_new</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros_like</span><span class="s1">(</span><span class="s13">B</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">k</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s17">num_unique_obs</span><span class="s1">):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s17">B_new</span><span class="s1">[:, </span><span class="s17">k</span><span class="s1">] = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">sum</span><span class="s1">(</span><span class="s17">gamma</span><span class="s1">[</span><span class="s17">seq</span><span class="s1"> == </span><span class="s17">k</span><span class="s1">], </span><span class="s17">axis</span><span class="s1">=</span><span class="s16">0</span><span class="s1">) / </span><span class="s14">np</span><span class="s1">.</span><span class="s15">sum</span><span class="s1">(</span><span class="s17">gamma</span><span class="s1">, </span><span class="s17">axis</span><span class="s1">=</span><span class="s16">0</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">pi_new</span><span class="s1"> = </span><span class="s17">gamma</span><span class="s1">[</span><span class="s16">0</span><span class="s1">]</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s1"># Check for convergence</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s10">if</span><span class="s11"> </span><span class="s14">np</span><span class="s11">.</span><span class="s1">max</span><span class="s11">(</span><span class="s14">np</span><span class="s11">.</span><span class="s1">abs</span><span class="s11">(</span><span class="s1">A_new</span><span class="s11"> - </span><span class="s13">A</span><span class="s11">)) &lt; </span><span class="s1">threshold</span><span class="s11"> </span><span class="s12">and</span><span class="s11"> </span><span class="s14">np</span><span class="s11">.</span><span class="s1">max</span><span class="s11">(</span><span class="s14">np</span><span class="s11">.</span><span class="s1">abs</span><span class="s11">(</span><span class="s1">B_new</span><span class="s11"> - </span><span class="s13">B</span><span class="s11">)) &lt; </span><span class="s1">threshold</span><span class="s11"> </span><span class="s12">and</span><span class="s11"> </span><span class="s14">np</span><span class="s11">.</span><span class="s1">max</span><span class="s11">(</span><span class="s14">np</span><span class="s11">.</span><span class="s1">abs</span><span class="s11">(</span><span class="s1">pi_new</span><span class="s11"> - </span><span class="s1">pi</span><span class="s11">)) &lt; </span><span class="s1">threshold</span><span class="s11">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s10">break</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s1"># Update the model parameters</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">A</span><span class="s1"> = </span><span class="s17">A_new</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">B</span><span class="s1"> = </span><span class="s17">B_new</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">pi</span><span class="s1"> = </span><span class="s17">pi_new</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1"># Calculate the log-likelihood of the sequence using the final model parameters</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s17">alpha_final</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">.</span><span class="s15">zeros</span><span class="s1">((</span><span class="s15">len</span><span class="s1">(</span><span class="s17">seq</span><span class="s1">), </span><span class="s13">N</span><span class="s1">))</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">for</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> </span><span class="s12">in</span><span class="s1"> </span><span class="s14">range</span><span class="s1">(</span><span class="s15">len</span><span class="s1">(</span><span class="s17">seq</span><span class="s1">)):</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">if</span><span class="s1"> </span><span class="s17">t</span><span class="s1"> == </span><span class="s16">0</span><span class="s1">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s17">alpha_final</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s17">pi</span><span class="s1"> * </span><span class="s13">B</span><span class="s1">[:, </span><span class="s17">seq</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]]</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s10">else</span><span class="s1">:</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s17">alpha_final</span><span class="s1">[</span><span class="s17">t</span><span class="s1">] = </span><span class="s13">B</span><span class="s1">[:, </span><span class="s17">seq</span><span class="s1">[</span><span class="s17">t</span><span class="s1">]] * </span><span class="s14">np</span><span class="s1">.</span><span class="s17">dot</span><span class="s1">(</span><span class="s17">alpha_final</span><span class="s1">[</span><span class="s17">t</span><span class="s1">-</span><span class="s16">1</span><span class="s1">], </span><span class="s13">A</span><span class="s1">)</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1">log_likelihood</span><span class="s11"> = </span><span class="s14">np</span><span class="s11">.</span><span class="s15">sum</span><span class="s11">(</span><span class="s14">np</span><span class="s11">.</span><span class="s1">log</span><span class="s11">(</span><span class="s14">np</span><span class="s11">.</span><span class="s15">sum</span><span class="s11">(</span><span class="s1">alpha_final</span><span class="s11">[-</span><span class="s16">1</span><span class="s11">])))</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p16"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s1"># Check if this model has a better likelihood than the previous models for this sequence</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s10">if</span><span class="s11"> </span><span class="s1">log_likelihood</span><span class="s11"> &gt; </span><span class="s1">max_likelihoods</span><span class="s11">[</span><span class="s1">seq_id</span><span class="s11">]:</span></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s1">max_likelihoods</span><span class="s11">[</span><span class="s1">seq_id</span><span class="s11">] = </span><span class="s1">log_likelihood</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s17">best_models</span><span class="s1">[</span><span class="s17">seq_id</span><span class="s1">] = {</span><span class="s20">'A'</span><span class="s1">: </span><span class="s13">A</span><span class="s1">, </span><span class="s20">'B'</span><span class="s1">: </span><span class="s13">B</span><span class="s1">, </span><span class="s20">'pi'</span><span class="s1">: </span><span class="s17">pi</span><span class="s1">}</span></p>
<p class="p15"><span class="s1"></span><br></p>
<p class="p19"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s10">for</span><span class="s11"> </span><span class="s1">seq_id</span><span class="s11">, </span><span class="s1">model_params</span><span class="s11"> </span><span class="s12">in</span><span class="s11"> </span><span class="s1">best_models</span><span class="s11">.</span><span class="s15">items</span><span class="s11">():</span></p>
<p class="p20"><span class="s11"><span class="Apple-converted-space">            </span></span><span class="s15">print</span><span class="s11">(f</span><span class="s1">"Best model for observation sequence {</span><span class="s17">seq_id</span><span class="s1">+1}:"</span><span class="s11">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s15">print</span><span class="s1">(f</span><span class="s20">"A = {</span><span class="s17">model_params</span><span class="s20">['A']}"</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s15">print</span><span class="s1">(f</span><span class="s20">"B = {</span><span class="s17">model_params</span><span class="s20">['B']}"</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s15">print</span><span class="s1">(f</span><span class="s20">"pi = {</span><span class="s17">model_params</span><span class="s20">['pi']}"</span><span class="s1">)</span></p>
<p class="p13"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s15">print</span><span class="s1">()</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">              </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
<h1 style="margin: 0.0px 0.0px 16.1px 0.0px; font: 24.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Extra Credit</span></h1>
<p class="p4"><span class="s1">For each of the three problems below, you are allowed to use only your own code. In other words, you are not allowed to use any other libraries or implementations for these problems.</span></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part EC1: Implement the Forward Algorithm with Re-Normalization</span></h2>
<p class="p2"><span class="s1">Source</span></p>
<p class="p8"><span class="s1">import numpy as np</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">def forward_renorm(O, A, B, pi):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Get the number of states and observations</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>N = A.shape[0]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>T = len(O)</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Initialize the scaling factor and scaled forward probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>scale = np.zeros(T)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>alpha = np.zeros((T, N))</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Calculate the initial scaled forward probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>alpha[0] = pi * B[:, O[0]]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>scale[0] = np.sum(alpha[0])</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>alpha[0] /= scale[0]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Calculate the scaled forward probabilities for the rest of the sequence</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for t in range(1, T):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>alpha[t] = B[:, O[t]] * np.dot(alpha[t-1], A)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>scale[t] = np.sum(alpha[t])</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>alpha[t] /= scale[t]</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Calculate the log-likelihood of the sequence</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>log_likelihood = np.sum(np.log(scale))</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>return alpha, scale, log_likelihood</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                 </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part EC2: Implement the Forward-Backward Algorithm with Re-Normalization</span></h2>
<p class="p2"><span class="s1">Source</span></p>
<p class="p8"><span class="s1">// import numpy as np</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">def forward_backward_renorm(obs, A, B, pi):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>"""</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>Implementation of the Forward-Backward algorithm with Re-Normalization.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>Parameters:</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>obs (list): list of observed states</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>A (ndarray): transition matrix</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>B (ndarray): emission matrix</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>pi (ndarray): initial state distribution</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>Returns:</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>alpha (ndarray): forward probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>beta (ndarray): backward probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>gamma (ndarray): state occupancy probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>"""</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Initialize forward and backward probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>T = len(obs)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>alpha = np.zeros((T, A.shape[0]))</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>beta = np.zeros((T, A.shape[0]))</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Calculate initial forward probability</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>alpha[0, :] = pi * B[:, obs[0]]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Normalize alpha</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>c_0 = 1 / np.sum(alpha[0])</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>alpha[0, :] = alpha[0, :] * c_0</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Calculate the rest of the forward probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for t in range(1, T):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>alpha[t, :] = np.dot(alpha[t-1, :], A) * B[:, obs[t]]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span># Normalize alpha</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>c_t = 1 / np.sum(alpha[t])</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>alpha[t, :] = alpha[t, :] * c_t</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span># Renormalize previous alpha values</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>alpha[:t, :] = alpha[:t, :] * c_t / c_0</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Calculate initial backward probability</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>beta[-1, :] = 1</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Normalize beta</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>beta[-1, :] = beta[-1, :] / np.sum(beta[-1, :])</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Calculate the rest of the backward probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for t in range(T-2, -1, -1):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>beta[t, :] = np.dot(A, beta[t+1, :] * B[:, obs[t+1]])</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span># Normalize beta</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>beta[t, :] = beta[t, :] / np.sum(beta[t, :])</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span># Renormalize previous beta values</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>beta[t+1:, :] = beta[t+1:, :] / np.sum(beta[t+1, :] * B[:, obs[t+1]])</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Calculate the state occupancy probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>gamma = alpha * beta</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>gamma = gamma / np.sum(gamma, axis=1, keepdims=True)</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>return alpha, beta, gamma</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                 </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<h2 style="margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Helvetica; -webkit-text-stroke: #000000"><span class="s1">Part EC3: Implement the Baum-Welch Algorithm</span></h2>
<p class="p2"><span class="s1">Source</span></p>
<p class="p8"><span class="s1">// import numpy as np</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1">def train_hmm(O, N, num_iterations=100, threshold=1e-6):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>"""</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>Trains a Hidden Markov Model using the Baum-Welch algorithm.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>Args:</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>O: a 1D numpy array representing the observed sequence</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>N: the number of hidden states in the model</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>num_iterations: the maximum number of iterations to run the algorithm for</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>threshold: the convergence threshold for the change in model parameters</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>Returns:</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>A: a numpy array representing the transition matrix</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>B: a numpy array representing the emission matrix</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>pi: a numpy array representing the initial state distribution</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>"""</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Define the maximum number of unique observations</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>num_unique_obs = len(set(O))</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Initialize the transition matrix, emission matrix, and initial state distribution randomly</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>A = np.random.rand(N, N)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>A /= A.sum(axis=1, keepdims=True)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>B = np.random.rand(N, num_unique_obs)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>B /= B.sum(axis=1, keepdims=True)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>pi = np.random.rand(N)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>pi /= pi.sum()</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span># Loop until convergence or maximum number of iterations is reached</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>for i in range(num_iterations):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span># Initialize the forward and backward probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>alpha = np.zeros((len(O), N))</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>beta = np.zeros((len(O), N))</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span># Compute the forward and backward probabilities</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>for t in range(len(O)):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>if t == 0:</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>alpha[t] = pi * B[:, O[t]]</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>beta[t] = 1</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>else:</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>alpha[t] = B[:, O[t]] * np.dot(alpha[t-1], A)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>beta[t] = np.dot(beta[t-1] * B[:, O[len(O)-1-t+1]], A.T)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>beta = np.flipud(beta)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>gamma = alpha * beta / np.sum(alpha[-1])</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span># Compute the expected sufficient statistics for the transition matrix</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>xi = np.zeros((len(O)-1, N, N))</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>for t in range(len(O)-1):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>xi[t] = alpha[t].reshape((-1, 1)) * A * B[:, O[t+1]].reshape((1, -1)) * beta[t+1].reshape((1, -1))</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>xi[t] /= np.sum(xi[t])</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span># Update the model parameters</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>A_new = np.sum(xi, axis=0) / np.sum(gamma[:-1], axis=0).reshape((-1, 1))</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>B_new = np.zeros_like(B)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>for k in range(num_unique_obs):</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>B_new[:, k] = np.sum(gamma[O == k], axis=0) / np.sum(gamma, axis=0)</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>pi_new = gamma[0]</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span># Check for convergence</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>if np.max(np.abs(A_new - A)) &lt; threshold and np.max(np.abs(B_new - B)) &lt; threshold and np.max(np.abs(pi_new - pi)) &lt; threshold:</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span>break</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span># Update the model parameters</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>A = A_new</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>B = B_new</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">        </span>pi = pi_new</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">    </span>return A, B, pi</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                 </span></span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Last updated 2023-04-05</span></p>
</body>
</html>
